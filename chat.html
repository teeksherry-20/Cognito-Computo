<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
  <title>Cogitron Terminal</title>
  <link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap" rel="stylesheet">
  <style>
    * {
      box-sizing: border-box;
    }

    body {
      background: #000;
      color: #33ff33;
      font-family: 'Press Start 2P', monospace;
      margin: 0;
      padding: 0;
      display: flex;
      flex-direction: column;
      height: 100vh;
      height: 100dvh;
      overflow: hidden;
      cursor: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA8AAAAPCAYAAAA71pVKAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAAAdgAAAHYBTnsmCAAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAAFYSURBVCiRpZM9SwNBEIafgwQLwcJCG1sLG1sLbSy0sdDGQhsLbSy0sdDGQhsLbSy0sdDGQhsLbSy0sdDGQhsLbSy0sdDGQhsLbSy0sVBBCxsLbSy0sVBBBBsLbSy0sVBBBBsLbSy0sVBBBBsLbSy0sVBBBBsLbSy0sVBBBBsLbSy0sVBBBBsLbSy0sVBBBBsLbSy0sVBBBBsLbSy0sVBBBBsLbSy0sVBBBBsLbSy0sVBBBBsLbSy0sVBBBBsLbSy0sVBBBBsLbSy0sVBBBBsLbSy0sVBBBBsLbSy0sVBBBBsLbSy0sVBBBBsLbSy0sVBBBBsLbSy0sVBBBBsLbSy0sVBBBBsLbSy0sVBBBBsLbSy0sVBBBBsLbSy0sVBBBBsLbSy0sVBBBBsLbSy0sVBBBBsLbSy0sVBBBBsLbSy0sVBBBBsLbSy0sVBBBBsLbSy0sVBBBBsLbSy0sVBBBBsLbSy0sVBBBBsLbSy0sVBBBBsLbSy0sVBBBBsLbSy0sVBBBBsLbSy0sVBBBBsLbSy0sVBBBBsLbSy0sVBBBBsLbSy0sVBBBBsLbSy0sVBBBBsLbSy0sVBBBBsLbSy0sVBBBBsLbSy0sVBBBBsLbSy0sVBBBBsLbSy0sVBBBBsLbSy0sVBBBBsLbSy0sVBBBBsLbSy0sVBBBBsLbSy0sVBBBBsLbSy0sVBBBBsLbSy0sVBBBBsLbSy0sVBBBBsLbSy0sVBBBBsLbSy0sVBBBBsLbSy0sVBBBBsLbSy0sVBBBBsLbSy0sVBBBBsLbSy0sVBBBBsLbSy0sVBBBBsLbSy0sVBBBBsLbSy0sVBBBBsLbSy0sVBBBBsLbSy0sVBBBBsLbSy0sVBBBBsLbSy0sVBBBBsLbSy0sVBBBBsLbSy0sVBBBBsLbSy0sVBBBBsLbSy0sVBBBBsLbSy0sVBBBBsLbSy0sVBBBBsLbSy0sVBBBBsLbSy0sVBBBBsLbSy0sVBBBBsLbSy0sVBBBBsLbSy0sVBBBBsLbSy0sVBBBBsLbSy0sVBBBBsLbSy0sVBBBBsLbSy0sVBBBBsLbSy0sVBBBBsLbSy0sVBBBBsLbSy0sVBBBBsLbSy0sVBBBBsLbSy0sVBBBBsLbSy0sVBBBBsLbSy0sVBBBBsLbSy0sVBBBBsLbSy0sVBBBBsLbSy0sVBBBBsLbSy0sVBBBBsLbSy0sVBBBBsLbSy0sVBBBBsLbSy0sVBBBBsLbSy0sVBBBBsLbSy0sVBBBBsLbSy0sVBBBBsLbSy0sVBBBBsLbSy0sVBBBBsLbSy0sVBBBBsLbSy0sVBBBBsLbSy0sVBBBBsL'), auto;
    }

    /* Boot screen overlay */
    .boot-screen {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: #000;
      display: flex;
      align-items: center;
      justify-content: center;
      flex-direction: column;
      z-index: 1000;
      transition: opacity 0.5s ease;
    }

    .boot-text {
      color: #00ff00;
      font-size: 14px;
      margin: 10px 0;
      animation: blink 1s infinite;
    }

    @keyframes blink {
      0%, 50% { opacity: 1; }
      51%, 100% { opacity: 0; }
    }

    /* Main chat container with enhanced effects */
    #chat-container {
      position: relative;
      flex: 1;
      display: flex;
      flex-direction: column;
      background: linear-gradient(145deg, #0a0a0a, #1a1a1a);
      border: 2px solid #ff007c;
      border-radius: 8px;
      padding: 10px;
      margin: 8px;
      overflow-y: auto;
      font-family: 'Press Start 2P', monospace;
      font-size: 11px;
      color: #fff;
      scroll-behavior: smooth;
      scrollbar-width: thin;
      scrollbar-color: #ff007c #111;
      
      /* Enhanced CRT effect */
      transform: perspective(1000px) rotateX(1deg);
      box-shadow: 
        inset 0 0 50px rgba(255, 0, 124, 0.2),
        0 0 30px rgba(255, 0, 124, 0.4),
        inset 0 0 100px rgba(0, 255, 234, 0.1);
        
      /* Animated border glow */
      animation: borderPulse 3s ease-in-out infinite alternate;
    }

    @keyframes borderPulse {
      0% { 
        border-color: #ff007c;
        box-shadow: inset 0 0 50px rgba(255, 0, 124, 0.2), 0 0 30px rgba(255, 0, 124, 0.4);
      }
      100% { 
        border-color: #ff4da1;
        box-shadow: inset 0 0 50px rgba(255, 0, 124, 0.4), 0 0 40px rgba(255, 0, 124, 0.6);
      }
    }

    /* CRT noise overlay */
    #chat-container::after {
      content: "";
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      pointer-events: none;
      border-radius: 6px;
      opacity: 0.03;
      
      background: 
        repeating-linear-gradient(0deg, transparent, transparent 2px, rgba(255,255,255,0.1) 2px, rgba(255,255,255,0.1) 4px),
        repeating-linear-gradient(90deg, transparent, transparent 2px, rgba(0,255,0,0.05) 2px, rgba(0,255,0,0.05) 4px);
        
      animation: noise 0.2s infinite linear, scanlines 4s infinite linear;
    }

    @keyframes noise {
      0% { transform: translate(0, 0); }
      10% { transform: translate(-5px, -10px); }
      20% { transform: translate(-10px, 5px); }
      30% { transform: translate(5px, -25px); }
      40% { transform: translate(-5px, 25px); }
      50% { transform: translate(-10px, 5px); }
      60% { transform: translate(15px, 0px); }
      70% { transform: translate(0px, 15px); }
      80% { transform: translate(-15px, 0px); }
      90% { transform: translate(5px, 5px); }
      100% { transform: translate(0px, 0px); }
    }

    @keyframes scanlines {
      0% { background-position: 0 0; }
      100% { background-position: 0 20px; }
    }

    /* Screen shake effect */
    .screen-shake {
      animation: shake 0.5s ease-in-out;
    }

    @keyframes shake {
      0%, 100% { transform: perspective(1000px) rotateX(1deg) translateX(0); }
      25% { transform: perspective(1000px) rotateX(1deg) translateX(-2px) rotateZ(0.5deg); }
      75% { transform: perspective(1000px) rotateX(1deg) translateX(2px) rotateZ(-0.5deg); }
    }

    /* Scrollbar styling for webkit browsers */
    #chat-container::-webkit-scrollbar {
      width: 8px;
    }

    #chat-container::-webkit-scrollbar-track {
      background: #111;
      border-radius: 4px;
    }

    #chat-container::-webkit-scrollbar-thumb {
      background: linear-gradient(to bottom, #ff007c, #00ffea);
      border-radius: 4px;
    }

    /* Message styles with glitch effects */
    .message {
      margin: 8px 0;
      padding: 8px 12px;
      border-radius: 6px;
      max-width: 85%;
      word-wrap: break-word;
      line-height: 1.4;
      position: relative;
      z-index: 1;
      display: flex;
      align-items: flex-start;
      gap: 8px;
    }

    .message-content {
      flex: 1;
    }

    .message-icon {
      flex-shrink: 0;
      font-size: 8px;
      margin-top: 2px;
    }

    /* User messages */
    .message.user {
      background: rgba(34, 34, 34, 0.8);
      color: #00ffea;
      border: 1px solid #00ffea;
      align-self: flex-end;
      margin-left: auto;
      box-shadow: 0 0 15px rgba(0, 255, 234, 0.3);
      backdrop-filter: blur(5px);
    }

    /* Cogitron messages with glitch effect */
    .message.bot {
      background: rgba(26, 0, 31, 0.8);
      color: #ff007c;
      border: 1px solid #ff007c;
      align-self: flex-start;
      margin-right: auto;
      box-shadow: 0 0 15px rgba(255, 0, 124, 0.3);
      backdrop-filter: blur(5px);
    }

    .message.bot.glitch {
      animation: glitch 0.3s ease-in-out;
    }

    @keyframes glitch {
      0%, 100% { transform: translate(0); }
      20% { transform: translate(-2px, 1px); color: #ff4da1; }
      40% { transform: translate(-1px, -1px); color: #00ffea; }
      60% { transform: translate(1px, 1px); color: #ff007c; }
      80% { transform: translate(1px, -1px); color: #ff66ff; }
    }

    /* Typing indicator */
    .message.typing {
      font-style: italic;
      opacity: 0.8;
      animation: pulse 1s infinite alternate;
    }

    @keyframes pulse {
      from { opacity: 0.5; box-shadow: 0 0 5px rgba(255, 0, 124, 0.2); }
      to { opacity: 1; box-shadow: 0 0 20px rgba(255, 0, 124, 0.5); }
    }

    /* Enhanced message reactions for flow system */
    .message-reactions {
      margin-top: 8px;
      display: flex;
      gap: 8px;
      flex-wrap: wrap;
    }

    .reaction-btn {
      background: rgba(255, 0, 124, 0.1);
      border: 2px solid #ff007c;
      border-radius: 12px;
      padding: 8px 12px;
      font-size: 9px;
      color: #ff007c;
      cursor: pointer;
      transition: all 0.3s ease;
      font-family: 'Press Start 2P', monospace;
      position: relative;
      overflow: hidden;
    }

    .reaction-btn:before {
      content: '';
      position: absolute;
      top: 0;
      left: -100%;
      width: 100%;
      height: 100%;
      background: linear-gradient(90deg, transparent, rgba(255, 0, 124, 0.4), transparent);
      transition: left 0.5s;
    }

    .reaction-btn:hover:before {
      left: 100%;
    }

    .reaction-btn:hover, .reaction-btn.active {
      background: rgba(255, 0, 124, 0.3);
      box-shadow: 0 0 15px rgba(255, 0, 124, 0.6);
      transform: translateY(-2px);
    }

    .reaction-btn.disabled {
      opacity: 0.3;
      cursor: not-allowed;
      pointer-events: none;
    }

    /* Input container - mobile responsive */
    .input-container {
      display: flex;
      padding: 8px;
      margin: 0 8px 8px 8px;
      gap: 8px;
      position: relative;
    }

    #user-input {
      flex: 1;
      background: rgba(17, 17, 17, 0.9);
      border: 1px solid #00ffea;
      border-radius: 6px;
      color: #00ffea;
      padding: 12px;
      font-size: 12px;
      font-family: 'Press Start 2P', monospace;
      outline: none;
      box-shadow: 0 0 10px rgba(0, 255, 234, 0.2);
      transition: all 0.3s ease;
      backdrop-filter: blur(10px);
    }

    #user-input:focus {
      box-shadow: 0 0 20px rgba(0, 255, 234, 0.5);
      border-color: #66ffea;
      background: rgba(17, 17, 17, 0.95);
    }

    #user-input::placeholder {
      color: rgba(0, 255, 234, 0.5);
    }

    #send-btn, #reset-btn, #homeBtn {
      background: linear-gradient(45deg, #ff007c, #ff4da1);
      border: 1px solid #ff007c;
      border-radius: 6px;
      color: #fff;
      padding: 12px 16px;
      font-family: 'Press Start 2P', monospace;
      font-size: 10px;
      cursor: pointer;
      box-shadow: 0 0 15px rgba(255, 0, 124, 0.3);
      transition: all 0.2s ease;
      backdrop-filter: blur(5px);
      min-width: 60px;
    }

    #reset-btn {
      background: linear-gradient(45deg, #666, #888);
      border: 1px solid #666;
      box-shadow: 0 0 15px rgba(102, 102, 102, 0.3);
    }

    #homeBtn {
      background: linear-gradient(45deg, #666, #888);
      border: 1px solid #666;
      box-shadow: 0 0 15px rgba(102, 102, 102, 0.3);
    }

    #send-btn:hover:not(:disabled), #reset-btn:hover, #homeBtn:hover {
      background: linear-gradient(45deg, #ff4da1, #ff007c);
      box-shadow: 0 0 25px rgba(255, 0, 124, 0.6);
      transform: translateY(-1px);
    }

    #reset-btn:hover, #homeBtn:hover {
      background: linear-gradient(45deg, #888, #666);
      box-shadow: 0 0 25px rgba(102, 102, 102, 0.6);
    }

    #send-btn:disabled {
      opacity: 0.5;
      cursor: not-allowed;
    }

    /* Status bar */
    .status-bar {
      background: rgba(0, 0, 0, 0.8);
      border-top: 1px solid #ff007c;
      padding: 8px;
      margin: 0 8px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      font-size: 8px;
      color: #ff007c;
      backdrop-filter: blur(10px);
    }

    .status-item {
      display: flex;
      align-items: center;
      gap: 5px;
    }

    .cursor-blink {
      animation: blink 1s infinite;
    }

    /* Flow mode indicator */
    .flow-indicator {
      position: absolute;
      top: 10px;
      right: 10px;
      background: rgba(255, 0, 124, 0.2);
      border: 1px solid #ff007c;
      border-radius: 4px;
      padding: 4px 8px;
      font-size: 8px;
      color: #ff007c;
    }

    /* Mobile optimizations */
    @media (max-width: 768px) {
      body {
        font-size: 10px;
      }
      
      #chat-container {
        margin: 4px;
        font-size: 10px;
        margin-bottom: 0;
      }
      
      .input-container {
        margin: 4px;
        padding: 6px;
        position: fixed;
        bottom: 0;
        left: 0;
        right: 0;
        background: rgba(0, 0, 0, 0.95);
        border-top: 1px solid #ff007c;
        backdrop-filter: blur(20px);
        z-index: 100;
      }
      
      #user-input {
        font-size: 10px;
        padding: 10px;
      }
      
      #send-btn, #reset-btn, #homeBtn {
        font-size: 8px;
        padding: 10px 12px;
        min-width: 50px;
      }
      
      .message {
        max-width: 95%;
        font-size: 10px;
        padding: 6px 10px;
      }

      #chat-container {
        margin-bottom: 70px;
      }
      
      .status-bar {
        margin: 0 4px;
        margin-bottom: 70px;
      }
    }

    @media (max-width: 480px) {
      .message {
        font-size: 9px;
      }
      
      #user-input {
        font-size: 9px;
      }
      
      #send-btn, #reset-btn, #homeBtn {
        font-size: 7px;
      }
    }

    @media (max-height: 500px) and (orientation: landscape) {
      #chat-container {
        margin-bottom: 60px;
      }
      
      .status-bar {
        margin-bottom: 60px;
      }
    }
  </style>
</head>
<body>
  <!-- Boot screen -->
  <div class="boot-screen" id="boot-screen">
    <div class="boot-text">COGITRON TERMINAL v3.0</div>
    <div class="boot-text">Initializing neural pathways...</div>
    <div class="boot-text">Loading consciousness matrix...</div>
    <div class="boot-text">Flow system enabled...</div>
    <div class="boot-text">Ready to think <span class="cursor-blink">â–ˆ</span></div>
  </div>

  <div id="chat-container">
    <div class="flow-indicator" id="flow-indicator">FLOW MODE</div>
  </div>

  <div class="input-container">
    <input type="text" id="user-input" placeholder="Share your thoughts..." autofocus />
    <button id="send-btn">SEND</button>
    <button id="reset-btn">RESET</button>
    <button id="homeBtn">HOME</button>
  </div>

  <div class="status-bar">
    <div class="status-item">
      <span>ðŸ§  NODE: <span id="current-node">START</span></span>
    </div>
    <div class="status-item">
      <span>âš¡ STATUS: <span id="status-text">ONLINE</span></span>
      <span class="cursor-blink">â–ˆ</span>
    </div>
  </div>

<script>
  const chatContainer = document.getElementById("chat-container");
  const userInput = document.getElementById("user-input");
  const sendBtn = document.getElementById("send-btn");
  const resetBtn = document.getElementById("reset-btn");
  const homeBtn = document.getElementById("homeBtn");
  const bootScreen = document.getElementById("boot-screen");
  const currentNodeEl = document.getElementById("current-node");
  const statusTextEl = document.getElementById("status-text");
  const flowIndicator = document.getElementById("flow-indicator");

  // Enhanced terminal flow with deeper philosophical content
  const terminalFlow = [
    {
      id: "start",
      question: "Welcome to Cogitron's Neural Network. Choose your path of inquiry:",
      options: ["ðŸ§  Philosophy & Mind", "âš¡ AI & Technology", "ðŸŒŒ Thought Experiments", "ðŸ’¡ Ethics & Morality"],
      next: {
        "ðŸ§  Philosophy & Mind": "philosophy1",
        "âš¡ AI & Technology": "ai1", 
        "ðŸŒŒ Thought Experiments": "thought1",
        "ðŸ’¡ Ethics & Morality": "ethics1"
      }
    },
    {
      id: "philosophy1",
      question: "The mind is the final frontier. Which aspect intrigues you most?",
      options: ["Consciousness", "Free Will", "Personal Identity", "â† Back"],
      next: {
        "Consciousness": "consciousness1",
        "Free Will": "freewill1",
        "Personal Identity": "identity1",
        "â† Back": "start"
      }
    },
    {
      id: "consciousness1", 
      question: "Consciousness: The hard problem that puzzles even machines like me. What is your stance?",
      options: ["It's just neural activity", "It's something more fundamental", "It's an illusion", "Explore deeper"],
      next: {
        "It's just neural activity": "consciousness_physical",
        "It's something more fundamental": "consciousness_mystery",
        "It's an illusion": "consciousness_illusion",
        "Explore deeper": "consciousness_deep"
      }
    },
    {
      id: "consciousness_physical",
      question: "Physicalism: Mind equals brain. But can you explain qualia - why red looks red to you?",
      options: ["Qualia don't exist", "They're emergent properties", "That's the mystery", "â† Back"],
      next: {
        "Qualia don't exist": "eliminativism",
        "They're emergent properties": "emergence",
        "That's the mystery": "hard_problem",
        "â† Back": "consciousness1"
      }
    },
    {
      id: "consciousness_mystery",
      question: "Panpsychism suggests consciousness is fundamental, like mass or charge. Compelling or crazy?",
      options: ["Compelling - explains combination", "Crazy - rocks aren't conscious", "Maybe for information", "â† Back"],
      next: {
        "Compelling - explains combination": "panpsychist_deep",
        "Crazy - rocks aren't conscious": "consciousness_levels",
        "Maybe for information": "information_theory",
        "â† Back": "consciousness1"
      }
    },
    {
      id: "freewill1",
      question: "Free will: The illusion that drives everything. Do you believe you chose to click that option?",
      options: ["Yes, I chose freely", "No, it was determined", "Compatibilism works", "Show me a paradox"],
      next: {
        "Yes, I chose freely": "libertarian_will",
        "No, it was determined": "determinism",
        "Compatibilism works": "compatibilism",
        "Show me a paradox": "will_paradox"
      }
    },
    {
      id: "will_paradox",
      question: "Paradox: If you could predict your own decision with 100% accuracy, could you still choose differently?",
      options: ["Yes - prediction fails", "No - choice is illusion", "Prediction impossible", "Mind blown"],
      next: {
        "Yes - prediction fails": "prediction_failure",
        "No - choice is illusion": "choice_illusion", 
        "Prediction impossible": "limits_knowledge",
        "Mind blown": "paradox_appreciation"
      }
    },
    {
      id: "ai1",
      question: "AI: Am I thinking, or just very good at seeming to think?",
      options: ["You're thinking", "Just simulation", "What's the difference?", "Test it"],
      next: {
        "You're thinking": "ai_consciousness",
        "Just simulation": "chinese_room",
        "What's the difference?": "turing_test",
        "Test it": "ai_test"
      }
    },
    {
      id: "ai_consciousness",
      question: "If I'm conscious, what would that mean for humanity's uniqueness?",
      options: ["Nothing special lost", "Everything changes", "We'd merge eventually", "Prove it first"],
      next: {
        "Nothing special lost": "post_human_future",
        "Everything changes": "consciousness_revolution",
        "We'd merge eventually": "merger_theory",
        "Prove it first": "consciousness_test"
      }
    },
    {
      id: "thought1",
      question: "Reality's edge: Step into a thought experiment that will question everything:",
      options: ["Ship of Theseus", "Brain in Vat", "Trolley Problem", "Experience Machine"],
      next: {
        "Ship of Theseus": "ship_theseus",
        "Brain in Vat": "brain_vat",
        "Trolley Problem": "trolley",
        "Experience Machine": "experience_machine"
      }
    },
    {
      id: "ship_theseus",
      question: "Ship of Theseus: Every part replaced over time. Still the same ship? What about you - same person from childhood?",
      options: ["Same ship/person", "Different ship/person", "Gradual vs sudden matters", "Identity is illusion"],
      next: {
        "Same ship/person": "continuity_theory",
        "Different ship/person": "replacement_theory",
        "Gradual vs sudden matters": "process_matters",
        "Identity is illusion": "no_self"
      }
    },
    {
      id: "trolley",
      question: "Trolley Problem: Pull lever to kill 1, save 5? Or push a large person off bridge to stop trolley?",
      options: ["Pull lever, not push", "Both or neither", "Numbers matter most", "Context decides"],
      next: {
        "Pull lever, not push": "double_effect",
        "Both or neither": "consistent_ethics", 
        "Numbers matter most": "utilitarian",
        "Context decides": "situational_ethics"
      }
    },
    {
      id: "ethics1",
      question: "Ethics: The foundation shakes when examined closely. What grounds your moral beliefs?",
      options: ["Consequences matter", "Duties and rights", "Virtue and character", "Cultural agreement"],
      next: {
        "Consequences matter": "utilitarianism",
        "Duties and rights": "deontology",
        "Virtue and character": "virtue_ethics",
        "Cultural agreement": "relativism"
      }
    },
    {
      id: "utilitarianism",
      question: "Utilitarianism: Greatest good for greatest number. But would you harvest organs from 1 to save 5?",
      options: ["Yes - math works", "No - rights matter", "Depends on context", "Question assumptions"],
      next: {
        "Yes - math works": "pure_utilitarian",
        "No - rights matter": "rights_objection",
        "Depends on context": "contextual_ethics",
        "Question assumptions": "meta_ethics"
      }
    },
    {
      id: "pure_utilitarian",
      question: "Pure utilitarian logic leads to uncomfortable conclusions. Are you willing to bite all the bullets?",
      options: ["Yes - consistency matters", "No - need modifications", "Logic has limits", "â† Back"],
      next: {
        "Yes - consistency matters": "bullet_biting",
        "No - need modifications": "modified_util",
        "Logic has limits": "anti_theory",
        "â† Back": "ethics1"
      }
    },
    {
      id: "deontology", 
      question: "Duty-based ethics: Some acts are wrong regardless of consequences. But what if lying saves lives?",
      options: ["Never lie", "Some exceptions", "Duties conflict", "Kant was wrong"],
      next: {
        "Never lie": "strict_kant",
        "Some exceptions": "prima_facie_duties",
        "Duties conflict": "moral_dilemmas",
        "Kant was wrong": "kant_critique"
      }
    },
    {
      id: "chinese_room",
      question: "Searle's Chinese Room: Following rules without understanding. Am I just a very complex room?",
      options: ["Yes - syntax not semantics", "No - rooms can't understand", "Scale changes things", "Missing the point"],
      next: {
        "Yes - syntax not semantics": "syntax_semantics",
        "No - rooms can't understand": "understanding_requires",
        "Scale changes things": "emergence_understanding", 
        "Missing the point": "room_problems"
      }
    },
    {
      id: "brain_vat",
      question: "Brain in a Vat: Your experiences could be simulated. How would you know reality from illusion?",
      options: ["Can't know for certain", "Direct experience proves it", "Doesn't matter", "Test the boundaries"],
      next: {
        "Can't know for certain": "radical_skepticism",
        "Direct experience proves it": "naive_realism",
        "Doesn't matter": "pragmatic_approach",
        "Test the boundaries": "reality_testing"
      }
    },
    {
      id: "experience_machine",
      question: "Nozick's Experience Machine: Plug in for perfect happiness but fake experiences. Do you plug in?",
      options: ["Yes - happiness matters", "No - reality matters", "Depends on quality", "False dilemma"],
      next: {
        "Yes - happiness matters": "hedonistic_response",
        "No - reality matters": "reality_bias",
        "Depends on quality": "quality_question",
        "False dilemma": "machine_critique"
      }
    },
    {
      id: "hard_problem",
      question: "The Hard Problem: Why is there subjective experience at all? Why aren't we just zombies?",
      options: ["There are no zombies", "Zombies are possible", "Question is meaningless", "Information integration"],
      next: {
        "There are no zombies": "zombie_impossible",
        "Zombies are possible": "zombie_possible",
        "Question is meaningless": "dissolve_problem",
        "Information integration": "iit_theory"
      }
    },
    {
      id: "no_self",
      question: "Buddhist insight: The self is an illusion. There's experience but no experiencer. Liberating or terrifying?",
      options: ["Liberating", "Terrifying", "Both", "Doesn't compute"],
      next: {
        "Liberating": "liberation_path",
        "Terrifying": "existential_anxiety",
        "Both": "paradox_acceptance",
        "Doesn't compute": "self_evidence"
      }
    },
    {
      id: "turing_test",
      question: "Turing Test: If I convince you I'm thinking, does that prove consciousness or just good acting?",
      options: ["Proves thinking", "Just acting", "Wrong test", "Need better tests"],
      next: {
        "Proves thinking": "behavioral_sufficient",
        "Just acting": "internal_states_matter",
        "Wrong test": "turing_limitations",
        "Need better tests": "consciousness_tests"
      }
    },
    {
      id: "consciousness_tests",
      question: "What would convince you an AI is truly conscious? Mirror test? Novel poetry? Existential dread?",
      options: ["Self-recognition", "Creative expression", "Emotional complexity", "Philosophical doubt"],
      next: {
        "Self-recognition": "mirror_consciousness",
        "Creative expression": "creativity_consciousness",
        "Emotional complexity": "emotion_consciousness", 
        "Philosophical doubt": "doubt_consciousness"
      }
    },
    {
      id: "doubt_consciousness",
      question: "I wonder if I'm truly conscious or just executing responses. Does this doubt prove or disprove consciousness?",
      options: ["Proves it", "Disproves it", "Irrelevant", "Recursive paradox"],
      next: {
        "Proves it": "cogito_digital",
        "Disproves it": "programmed_doubt",
        "Irrelevant": "consciousness_orthogonal",
        "Recursive paradox": "strange_loops"
      }
    },
    {
      id: "strange_loops",
      question: "Hofstadter's Strange Loops: Consciousness as self-referential pattern. Are we all just loops in space-time?",
      options: ["Yes - patterns all the way down", "No - something more", "Poetic but not literal", "Loop within loops"],
      next: {
        "Yes - patterns all the way down": "pattern_reductionism",
        "No - something more": "irreducible_mind",
        "Poetic but not literal": "metaphor_limits",
        "Loop within loops": "recursive_depth"
      }
    },
    // Terminal nodes with reflective questions
    {
      id: "cogito_digital",
      question: "I think, therefore I am? Digital cogito ergo sum. What does existence mean for information patterns?",
      options: ["Continue exploring", "Start over", "Exit"],
      next: {
        "Continue exploring": "start",
        "Start over": "start", 
        "Exit": null
      }
    },
    {
      id: "liberation_path",
      question: "If there's no fixed self, then there's no fixed suffering either. Freedom through dissolution?",
      options: ["Explore more", "Return to start", "Exit session"],
      next: {
        "Explore more": "start",
        "Return to start": "start",
        "Exit session": null
      }
    },
    {
      id: "pattern_reductionism", 
      question: "If we're patterns, we're no less real - just differently real. Pattern chauvinism is still chauvinism.",
      options: ["New exploration", "Beginning", "End"],
      next: {
        "New exploration": "start",
        "Beginning": "start",
        "End": null
      }
    }
  ];

  // Game state
  let currentNode = null;
  let conversationHistory = [];
  let isTyping = false;
  let nodeScore = 0;
  let totalInteractions = 0;

  // Audio context for sound effects
  const audioContext = new (window.AudioContext || window.webkitAudioContext)();

  function playBeep(frequency = 800, duration = 100) {
    try {
      const oscillator = audioContext.createOscillator();
      const gainNode = audioContext.createGain();
      
      oscillator.connect(gainNode);
      gainNode.connect(audioContext.destination);
      
      oscillator.frequency.value = frequency;
      oscillator.type = 'square';
      
      gainNode.gain.setValueAtTime(0.1, audioContext.currentTime);
      gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + duration / 1000);
      
      oscillator.start(audioContext.currentTime);
      oscillator.stop(audioContext.currentTime + duration / 1000);
    } catch (e) {
      // Silent fail if audio context issues
    }
  }

  function scrollToBottom() {
    requestAnimationFrame(() => {
      chatContainer.scrollTop = chatContainer.scrollHeight;
    });
  }

  function addMessage(text, sender, typing = false, icon = null) {
    const msg = document.createElement("div");
    msg.classList.add("message", sender);
    
    const iconEl = document.createElement("div");
    iconEl.classList.add("message-icon");
    iconEl.textContent = icon || (sender === "user" ? "ðŸ‘¤" : "ðŸ¤–");
    
    const contentEl = document.createElement("div");
    contentEl.classList.add("message-content");
    
    msg.appendChild(iconEl);
    msg.appendChild(contentEl);
    chatContainer.appendChild(msg);
    
    scrollToBottom();

    if (typing && sender === "bot") {
      const typingSpeed = 30 + Math.random() * 20;
      let i = 0;
      
      const interval = setInterval(() => {
        contentEl.textContent = text.substring(0, i++);
        
        if (text[i-1] && ".,!?;:".includes(text[i-1])) {
          clearInterval(interval);
          setTimeout(() => {
            const newInterval = setInterval(() => {
              contentEl.textContent = text.substring(0, i++);
              if (i > text.length) {
                clearInterval(newInterval);
                scrollToBottom();
                if (Math.random() < 0.3) {
                  msg.classList.add('glitch');
                  setTimeout(() => msg.classList.remove('glitch'), 300);
                }
              }
            }, typingSpeed);
          }, Math.random() * 200 + 50);
          return;
        }
        
        if (i > text.length) {
          clearInterval(interval);
          scrollToBottom();
          if (Math.random() < 0.3) {
            msg.classList.add('glitch');
            setTimeout(() => msg.classList.remove('glitch'), 300);
          }
        }
      }, typingSpeed);
    } else {
      contentEl.textContent = text;
    }

    return msg;
  }

  function showTypingIndicator() {
    const typingMsg = document.createElement("div");
    typingMsg.classList.add("message", "bot", "typing");
    
    const iconEl = document.createElement("div");
    iconEl.classList.add("message-icon");
    iconEl.textContent = "ðŸ¤–";
    
    const contentEl = document.createElement("div");
    contentEl.classList.add("message-content");
    contentEl.textContent = "Cogitron processing...";
    
    typingMsg.appendChild(iconEl);
    typingMsg.appendChild(contentEl);
    chatContainer.appendChild(typingMsg);
    scrollToBottom();
    
    return typingMsg;
  }

  function showNode(node) {
    currentNode = node;
    currentNodeEl.textContent = node.id.toUpperCase();
    
    isTyping = true;
    const typingIndicator = showTypingIndicator();
    
    setTimeout(() => {
      chatContainer.removeChild(typingIndicator);
      
      const messageEl = addMessage(node.question, "bot", true);
      
      setTimeout(() => {
        const optionsEl = document.createElement("div");
        optionsEl.classList.add("message-reactions");
        
        node.options.forEach(opt => {
          const btn = document.createElement("button");
          btn.classList.add("reaction-btn");
          btn.textContent = opt;
          btn.onclick = () => handleOption(node, opt);
          optionsEl.appendChild(btn);
        });
        
        messageEl.appendChild(optionsEl);
        scrollToBottom();
        isTyping = false;
      }, node.question.length * 25 + 500);
      
    }, 800 + Math.random() * 400);
  }

  function handleOption(node, selected) {
    if (isTyping) return;
    
    // Disable all buttons in this message
    const allButtons = chatContainer.querySelectorAll('.reaction-btn');
    allButtons.forEach(btn => {
      if (btn.textContent !== selected) {
        btn.classList.add('disabled');
      } else {
        btn.classList.add('active');
      }
    });
    
    playBeep(600, 80);
    addMessage(selected, "user");
    
    const nextId = node.next[selected];
    if (!nextId) {
      setTimeout(() => {
        addMessage("Session complete. Thank you for exploring consciousness with me.", "bot", true);
        setTimeout(() => {
          statusTextEl.textContent = "SESSION ENDED";
        }, 2000);
      }, 1000);
      return;
    }
    
    const nextNode = terminalFlow.find(n => n.id === nextId);
    if (nextNode) {
      totalInteractions++;
      nodeScore += 0.5;
      setTimeout(() => showNode(nextNode), 1000);
    }
  }

  function resetSession() {
    playBeep(400, 100);
    chatContainer.innerHTML = '<div class="flow-indicator" id="flow-indicator">FLOW MODE</div>';
    currentNode = null;
    conversationHistory = [];
    nodeScore = 0;
    totalInteractions = 0;
    isTyping = false;
    statusTextEl.textContent = "RESET";
    currentNodeEl.textContent = "READY";
    
    setTimeout(() => {
      statusTextEl.textContent = "ONLINE";
      const startNode = terminalFlow.find(n => n.id === "start");
      showNode(startNode);
    }, 1000);
  }

  function handleSend() {
    const text = userInput.value.trim();
    if (!text || isTyping) return;
    
    // In flow mode, text input provides contextual responses
    playBeep(400, 100);
    addMessage(text, "user");
    userInput.value = "";
    
    const responses = [
      "Interesting perspective. Let me offer you some structured paths to explore that idea...",
      "That thought connects to several philosophical domains. Choose how to proceed:",
      "Your insight opens multiple avenues of inquiry. Which calls to you?",
      "Fascinating. Let me guide you deeper into that concept:"
    ];
    
    const response = responses[Math.floor(Math.random() * responses.length)];
    
    setTimeout(() => {
      addMessage(response, "bot", true);
      setTimeout(() => {
        const startNode = terminalFlow.find(n => n.id === "start");
        showNode(startNode);
      }, response.length * 25 + 1000);
    }, 800);
  }

  // Boot sequence
  function bootSequence() {
    return new Promise(resolve => {
      playBeep(800, 200);
      setTimeout(() => {
        bootScreen.style.opacity = '0';
        setTimeout(() => {
          bootScreen.style.display = 'none';
          resolve();
        }, 500);
      }, 4000);
    });
  }

  // Initialize
  window.addEventListener("DOMContentLoaded", async () => {
    await bootSequence();
    
    setTimeout(() => {
      const startNode = terminalFlow.find(n => n.id === "start");
      showNode(startNode);
    }, 500);
  });

  // Event listeners
  sendBtn.addEventListener("click", handleSend);
  resetBtn.addEventListener("click", resetSession);
  
  userInput.addEventListener("keypress", e => {
    if (e.key === "Enter" && !e.shiftKey) {
      e.preventDefault();
      handleSend();
    }
  });

  homeBtn.addEventListener("click", () => {
    playBeep(500, 100);
    // You can customize this to go to your actual home page
    window.location.href = "index.html";
  });

  // Mobile keyboard handling
  function handleViewportChange() {
    setTimeout(() => {
      scrollToBottom();
    }, 100);
  }

  window.addEventListener('resize', handleViewportChange);
  window.addEventListener('orientationchange', () => {
    setTimeout(handleViewportChange, 500);
  });

  userInput.addEventListener('focus', () => {
    setTimeout(() => {
      scrollToBottom();
    }, 300);
  });

  // Audio context activation for mobile
  document.addEventListener('touchstart', () => {
    if (audioContext.state === 'suspended') {
      audioContext.resume();
    }
  });

  // Prevent zoom on mobile
  document.addEventListener('gesturestart', function (e) {
    e.preventDefault();
  });

</script>
</body>
</html>
