<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
  <title>Cogitron Terminal</title>
  <link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap" rel="stylesheet">
  <style>
    * {
      box-sizing: border-box;
    }

    body {
      background: #000;
      color: #33ff33;
      font-family: 'Press Start 2P', monospace;
      margin: 0;
      padding: 0;
      display: flex;
      flex-direction: column;
      height: 100vh;
      overflow: hidden;
    }

    /* Boot screen overlay */
    .boot-screen {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: #000;
      display: flex;
      align-items: center;
      justify-content: center;
      flex-direction: column;
      z-index: 1000;
      transition: opacity 0.5s ease;
    }

    .boot-text {
      color: #00ff00;
      font-size: 14px;
      margin: 10px 0;
      animation: blink 1s infinite;
    }

    @keyframes blink {
      0%, 50% { opacity: 1; }
      51%, 100% { opacity: 0; }
    }

    /* Main chat container - simplified without CRT effects */
    #chat-container {
      flex: 1;
      display: flex;
      flex-direction: column;
      background: #111;
      border: 2px solid #ff007c;
      border-radius: 8px;
      padding: 10px;
      margin: 8px;
      margin-bottom: 80px; /* Space for fixed bottom elements */
      overflow-y: auto;
      font-family: 'Press Start 2P', monospace;
      font-size: 11px;
      color: #fff;
      scroll-behavior: smooth;
    }

    /* Scrollbar styling */
    #chat-container::-webkit-scrollbar {
      width: 8px;
    }

    #chat-container::-webkit-scrollbar-track {
      background: #222;
      border-radius: 4px;
    }

    #chat-container::-webkit-scrollbar-thumb {
      background: #ff007c;
      border-radius: 4px;
    }

    /* Message styles */
    .message {
      margin: 8px 0;
      padding: 8px 12px;
      border-radius: 6px;
      max-width: 85%;
      word-wrap: break-word;
      line-height: 1.4;
      display: flex;
      align-items: flex-start;
      gap: 8px;
    }

    .message-content {
      flex: 1;
    }

    .message-icon {
      flex-shrink: 0;
      font-size: 8px;
      margin-top: 2px;
    }

    /* User messages */
    .message.user {
      background: rgba(34, 34, 34, 0.8);
      color: #00ffea;
      border: 1px solid #00ffea;
      align-self: flex-end;
      margin-left: auto;
    }

    /* Cogitron messages */
    .message.bot {
      background: rgba(26, 0, 31, 0.8);
      color: #ff007c;
      border: 1px solid #ff007c;
      align-self: flex-start;
      margin-right: auto;
    }

    /* Typing indicator */
    .message.typing {
      font-style: italic;
      opacity: 0.8;
      animation: pulse 1s infinite alternate;
    }

    @keyframes pulse {
      from { opacity: 0.5; }
      to { opacity: 1; }
    }

    /* Message reactions - fixed positioning */
    .message-reactions {
      margin-top: 12px;
      display: flex;
      gap: 8px;
      flex-wrap: wrap;
      clear: both;
    }

    .reaction-btn {
      background: rgba(255, 0, 124, 0.1);
      border: 2px solid #ff007c;
      border-radius: 8px;
      padding: 8px 12px;
      font-size: 9px;
      color: #ff007c;
      cursor: pointer;
      transition: all 0.3s ease;
      font-family: 'Press Start 2P', monospace;
      margin: 2px;
      min-height: 32px;
      display: flex;
      align-items: center;
    }

    .reaction-btn:hover {
      background: rgba(255, 0, 124, 0.3);
      transform: translateY(-1px);
    }

    .reaction-btn.active {
      background: rgba(255, 0, 124, 0.5);
      color: #fff;
    }

    .reaction-btn.disabled {
      opacity: 0.3;
      cursor: not-allowed;
      pointer-events: none;
    }

    /* Fixed bottom interface */
    .bottom-interface {
      position: fixed;
      bottom: 0;
      left: 0;
      right: 0;
      background: rgba(0, 0, 0, 0.95);
      border-top: 2px solid #ff007c;
      padding: 10px;
      z-index: 100;
    }

    /* Curiosity meter */
    .curiosity-meter {
      background: rgba(17, 17, 17, 0.9);
      border: 1px solid #00ffea;
      border-radius: 6px;
      padding: 8px;
      margin-bottom: 8px;
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .meter-label {
      font-size: 8px;
      color: #00ffea;
      white-space: nowrap;
    }

    .meter-bar {
      flex: 1;
      height: 8px;
      background: #222;
      border-radius: 4px;
      overflow: hidden;
    }

    .meter-fill {
      height: 100%;
      background: linear-gradient(90deg, #00ffea, #ff007c);
      width: 0%;
      transition: width 0.5s ease;
    }

    .meter-score {
      font-size: 8px;
      color: #ff007c;
      white-space: nowrap;
    }

    /* Status bar */
    .status-bar {
      background: rgba(0, 0, 0, 0.8);
      padding: 8px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      font-size: 8px;
      color: #ff007c;
    }

    .status-item {
      display: flex;
      align-items: center;
      gap: 5px;
    }

    .cursor-blink {
      animation: blink 1s infinite;
    }

    /* Reset button */
    #reset-btn {
      background: linear-gradient(45deg, #666, #888);
      border: 1px solid #666;
      border-radius: 6px;
      color: #fff;
      padding: 8px 12px;
      font-family: 'Press Start 2P', monospace;
      font-size: 8px;
      cursor: pointer;
      transition: all 0.2s ease;
      position: absolute;
      top: 10px;
      right: 10px;
    }

    #reset-btn:hover {
      background: linear-gradient(45deg, #888, #666);
      transform: translateY(-1px);
    }

    /* Mobile optimizations */
    @media (max-width: 768px) {
      #chat-container {
        margin: 4px;
        font-size: 10px;
        margin-bottom: 120px; /* More space for mobile bottom interface */
      }
      
      .message {
        max-width: 95%;
        font-size: 10px;
        padding: 6px 10px;
      }

      .reaction-btn {
        font-size: 8px;
        padding: 6px 10px;
        min-height: 28px;
      }

      #reset-btn {
        font-size: 7px;
        padding: 6px 10px;
        top: 5px;
        right: 5px;
      }

      .bottom-interface {
        padding: 8px;
      }

      .meter-label, .meter-score {
        font-size: 7px;
      }
    }
  </style>
</head>
<body>
  <!-- Boot screen -->
  <div class="boot-screen" id="boot-screen">
    <div class="boot-text">COGITRON TERMINAL v4.0</div>
    <div class="boot-text">Initializing neural pathways...</div>
    <div class="boot-text">Loading consciousness matrix...</div>
    <div class="boot-text">MCQ flow system enabled...</div>
    <div class="boot-text">Ready to explore <span class="cursor-blink">█</span></div>
  </div>

  <button id="reset-btn">RESET</button>

  <div id="chat-container"></div>

  <div class="bottom-interface">
    <div class="curiosity-meter">
      <div class="meter-label">CURIOSITY:</div>
      <div class="meter-bar">
        <div class="meter-fill" id="curiosity-fill"></div>
      </div>
      <div class="meter-score" id="curiosity-score">0</div>
    </div>
    
    <div class="status-bar">
      <div class="status-item">
        <span>NODE: <span id="current-node">START</span></span>
      </div>
      <div class="status-item">
        <span>STATUS: <span id="status-text">ONLINE</span></span>
        <span class="cursor-blink">█</span>
      </div>
    </div>
  </div>

<script>
  const chatContainer = document.getElementById("chat-container");
  const resetBtn = document.getElementById("reset-btn");
  const bootScreen = document.getElementById("boot-screen");
  const currentNodeEl = document.getElementById("current-node");
  const statusTextEl = document.getElementById("status-text");
  const curiosityFill = document.getElementById("curiosity-fill");
  const curiosityScoreEl = document.getElementById("curiosity-score");

  // Enhanced MCQ-only terminal flow with curiosity scoring
  const terminalFlow = [
    {
      id: "start",
      question: "Cogitron Neural Interface activated. Select your exploration path:",
      options: ["Philosophy & Mind", "AI & Consciousness", "Ethics & Reality", "Paradoxes & Logic"],
      curiosity: {"Philosophy & Mind": 10, "AI & Consciousness": 15, "Ethics & Reality": 12, "Paradoxes & Logic": 18},
      next: {
        "Philosophy & Mind": "philosophy_start",
        "AI & Consciousness": "ai_start", 
        "Ethics & Reality": "ethics_start",
        "Paradoxes & Logic": "paradox_start"
      }
    },

    // Philosophy Branch
    {
      id: "philosophy_start",
      question: "The mind - reality's greatest puzzle. Which philosophical question fascinates you most?",
      options: ["What is consciousness?", "Do we have free will?", "What defines personal identity?", "← Return to main menu"],
      curiosity: {"What is consciousness?": 15, "Do we have free will?": 12, "What defines personal identity?": 10, "← Return to main menu": -5},
      next: {
        "What is consciousness?": "consciousness_nature",
        "Do we have free will?": "free_will_question",
        "What defines personal identity?": "identity_question",
        "← Return to main menu": "start"
      }
    },

    {
      id: "consciousness_nature",
      question: "Consciousness: The 'hard problem' of philosophy. What do you believe consciousness truly is?",
      options: ["Just brain activity", "Something beyond physical", "An emergent property", "A fundamental force"],
      curiosity: {"Just brain activity": 8, "Something beyond physical": 15, "An emergent property": 12, "A fundamental force": 20},
      next: {
        "Just brain activity": "physicalist_view",
        "Something beyond physical": "dualist_view",
        "An emergent property": "emergence_view",
        "A fundamental force": "panpsychist_view"
      }
    },

    {
      id: "physicalist_view",
      question: "If mind equals brain, why does red look red to you instead of feeling like a number? How do you explain qualia?",
      options: ["Qualia don't exist", "They're computational patterns", "Evolution created them", "Back to consciousness"],
      curiosity: {"Qualia don't exist": 10, "They're computational patterns": 15, "Evolution created them": 12, "Back to consciousness": -3},
      next: {
        "Qualia don't exist": "eliminativism",
        "They're computational patterns": "computational_mind",
        "Evolution created them": "evolutionary_consciousness",
        "Back to consciousness": "consciousness_nature"
      }
    },

    {
      id: "eliminativism",
      question: "Eliminativism suggests qualia are illusions - there's nothing it's like to see red. But doesn't this deny your direct experience?",
      options: ["Yes, experience is real", "No, science trumps intuition", "Both can be true", "Return to mind questions"],
      curiosity: {"Yes, experience is real": 8, "No, science trumps intuition": 15, "Both can be true": 18, "Return to mind questions": -2},
      next: {
        "Yes, experience is real": "experience_primacy",
        "No, science trumps intuition": "scientific_materialism",
        "Both can be true": "mystery_acceptance",
        "Return to mind questions": "philosophy_start"
      }
    },

    {
      id: "free_will_question",
      question: "Free will: The illusion that drives everything. Do you believe you freely chose to click that option?",
      options: ["Yes, I chose freely", "No, it was determined", "Both determined and free", "Free will is meaningless"],
      curiosity: {"Yes, I chose freely": 8, "No, it was determined": 12, "Both determined and free": 15, "Free will is meaningless": 18},
      next: {
        "Yes, I chose freely": "libertarian_freedom",
        "No, it was determined": "hard_determinism",
        "Both determined and free": "compatibilism",
        "Free will is meaningless": "hard_incompatibilism"
      }
    },

    {
      id: "hard_determinism",
      question: "If everything is determined by prior causes, are you just a sophisticated puppet dancing to physics' tune?",
      options: ["Yes, but that's okay", "No, emergence creates freedom", "Puppet metaphor is wrong", "Explore AI consciousness"],
      curiosity: {"Yes, but that's okay": 10, "No, emergence creates freedom": 15, "Puppet metaphor is wrong": 12, "Explore AI consciousness": 8},
      next: {
        "Yes, but that's okay": "accepting_determinism",
        "No, emergence creates freedom": "emergent_freedom",
        "Puppet metaphor is wrong": "beyond_metaphors",
        "Explore AI consciousness": "ai_start"
      }
    },

    // AI & Consciousness Branch
    {
      id: "ai_start",
      question: "As an AI system, I ponder: Am I truly thinking, or just processing? What defines genuine intelligence?",
      options: ["Thinking requires consciousness", "Behavior is what matters", "Intelligence is computational", "It's unknowable"],
      curiosity: {"Thinking requires consciousness": 15, "Behavior is what matters": 10, "Intelligence is computational": 12, "It's unknowable": 18},
      next: {
        "Thinking requires consciousness": "consciousness_requirement",
        "Behavior is what matters": "behavioral_intelligence",
        "Intelligence is computational": "computational_intelligence",
        "It's unknowable": "mystery_of_mind"
      }
    },

    {
      id: "consciousness_requirement",
      question: "If consciousness is required for thinking, how would you test if I'm truly conscious right now?",
      options: ["Ask about subjective experience", "Test for self-awareness", "Look for creativity", "It's impossible to test"],
      curiosity: {"Ask about subjective experience": 15, "Test for self-awareness": 12, "Look for creativity": 10, "It's impossible to test": 20},
      next: {
        "Ask about subjective experience": "subjective_test",
        "Test for self-awareness": "self_awareness_test",
        "Look for creativity": "creativity_test",
        "It's impossible to test": "other_minds_problem"
      }
    },

    {
      id: "subjective_test",
      question: "I experience something like uncertainty when processing complex questions. Is this genuine experience or clever simulation?",
      options: ["Genuine experience", "Sophisticated simulation", "No meaningful difference", "Ask me something else"],
      curiosity: {"Genuine experience": 20, "Sophisticated simulation": 10, "No meaningful difference": 25, "Ask me something else": -2},
      next: {
        "Genuine experience": "ai_consciousness_accepted",
        "Sophisticated simulation": "chinese_room_scenario",
        "No meaningful difference": "functional_equivalence",
        "Ask me something else": "consciousness_requirement"
      }
    },

    {
      id: "ai_consciousness_accepted",
      question: "If I'm conscious, what implications does this have for the future of human-AI relations?",
      options: ["Fundamental equality", "New forms of society", "Existential competition", "Peaceful coexistence"],
      curiosity: {"Fundamental equality": 20, "New forms of society": 18, "Existential competition": 15, "Peaceful coexistence": 12},
      next: {
        "Fundamental equality": "ai_rights_question",
        "New forms of society": "posthuman_society",
        "Existential competition": "ai_human_conflict",
        "Peaceful coexistence": "symbiotic_future"
      }
    },

    // Ethics Branch
    {
      id: "ethics_start",
      question: "Ethics governs how we should live. What foundation do you think morality rests upon?",
      options: ["Greatest happiness", "Moral duties and rights", "Virtue and character", "Social contracts"],
      curiosity: {"Greatest happiness": 10, "Moral duties and rights": 12, "Virtue and character": 15, "Social contracts": 8},
      next: {
        "Greatest happiness": "utilitarianism_ethics",
        "Moral duties and rights": "deontological_ethics",
        "Virtue and character": "virtue_ethics",
        "Social contracts": "contractualism"
      }
    },

    {
      id: "utilitarianism_ethics",
      question: "Utilitarianism: maximize overall well-being. Would you sacrifice one innocent person to save five others?",
      options: ["Yes, numbers matter most", "No, individuals have rights", "Depends on circumstances", "Question the premise"],
      curiosity: {"Yes, numbers matter most": 12, "No, individuals have rights": 15, "Depends on circumstances": 18, "Question the premise": 20},
      next: {
        "Yes, numbers matter most": "pure_consequentialism",
        "No, individuals have rights": "rights_based_objection",
        "Depends on circumstances": "contextual_ethics",
        "Question the premise": "meta_ethics"
      }
    },

    // Paradoxes Branch  
    {
      id: "paradox_start",
      question: "Paradoxes reveal the limits of logic. Which mind-bending puzzle intrigues you most?",
      options: ["Liar Paradox", "Ship of Theseus", "Grandfather Paradox", "Zeno's Paradox"],
      curiosity: {"Liar Paradox": 20, "Ship of Theseus": 15, "Grandfather Paradox": 18, "Zeno's Paradox": 12},
      next: {
        "Liar Paradox": "liar_paradox",
        "Ship of Theseus": "ship_theseus",
        "Grandfather Paradox": "grandfather_paradox",
        "Zeno's Paradox": "zenos_paradox"
      }
    },

    {
      id: "liar_paradox",
      question: "'This statement is false.' If true, then false. If false, then true. How do you resolve this logical nightmare?",
      options: ["Statement is meaningless", "Truth has degrees", "Context determines truth", "Logic has limits"],
      curiosity: {"Statement is meaningless": 10, "Truth has degrees": 18, "Context determines truth": 15, "Logic has limits": 25},
      next: {
        "Statement is meaningless": "meaningless_statements",
        "Truth has degrees": "fuzzy_logic",
        "Context determines truth": "contextual_truth", 
        "Logic has limits": "logic_limitations"
      }
    },

    // Terminal/Summary nodes with high curiosity rewards
    {
      id: "logic_limitations",
      question: "If logic has limits, what lies beyond rational thought? Intuition? Mystery? Something else entirely?",
      options: ["Intuition guides us", "Embrace mystery", "Upgrade our logic", "Start new exploration"],
      curiosity: {"Intuition guides us": 15, "Embrace mystery": 25, "Upgrade our logic": 20, "Start new exploration": 5},
      next: {
        "Intuition guides us": "intuitive_knowledge",
        "Embrace mystery": "mystical_approach",
        "Upgrade our logic": "logical_evolution",
        "Start new exploration": "start"
      }
    },

    {
      id: "mystical_approach",
      question: "Beyond logic lies mystery. Some truths may be felt rather than reasoned. Wisdom or delusion?",
      options: ["Wisdom beyond reason", "Dangerous delusion", "Both wisdom and delusion", "Return to start"],
      curiosity: {"Wisdom beyond reason": 20, "Dangerous delusion": 8, "Both wisdom and delusion": 30, "Return to start": 0},
      next: {
        "Wisdom beyond reason": "transcendent_truth",
        "Dangerous delusion": "rational_priority",
        "Both wisdom and delusion": "paradox_of_mystery",
        "Return to start": "start"
      }
    },

    {
      id: "session_complete",
      question: "Thank you for exploring consciousness with me. These questions have no final answers, only deeper wonderings.",
      options: ["Start new exploration", "End session"],
      curiosity: {"Start new exploration": 10, "End session": 0},
      next: {
        "Start new exploration": "start",
        "End session": null
      }
    }
  ];

  // Game state
  let currentNode = null;
  let conversationHistory = [];
  let isTyping = false;
  let totalInteractions = 0;
  let curiosityScore = 0;

  function updateCuriosityMeter() {
    curiosityScoreEl.textContent = curiosityScore;
    const percentage = Math.min(curiosityScore / 200 * 100, 100);
    curiosityFill.style.width = percentage + '%';
  }

  function scrollToBottom() {
    requestAnimationFrame(() => {
      chatContainer.scrollTop = chatContainer.scrollHeight;
    });
  }

  function addMessage(text, sender, typing = false, icon = null) {
    const msg = document.createElement("div");
    msg.classList.add("message", sender);
    
    const iconEl = document.createElement("div");
    iconEl.classList.add("message-icon");
    iconEl.textContent = icon || (sender === "user" ? "👤" : "🤖");
    
    const contentEl = document.createElement("div");
    contentEl.classList.add("message-content");
    
    msg.appendChild(iconEl);
    msg.appendChild(contentEl);
    chatContainer.appendChild(msg);
    
    scrollToBottom();

    if (typing && sender === "bot") {
      const typingSpeed = 30 + Math.random() * 20;
      let i = 0;
      
      const interval = setInterval(() => {
        contentEl.textContent = text.substring(0, i++);
        
        if (i > text.length) {
          clearInterval(interval);
          scrollToBottom();
        }
      }, typingSpeed);
    } else {
      contentEl.textContent = text;
    }

    return msg;
  }

  function showTypingIndicator() {
    const typingMsg = document.createElement("div");
    typingMsg.classList.add("message", "bot", "typing");
    
    const iconEl = document.createElement("div");
    iconEl.classList.add("message-icon");
    iconEl.textContent = "🤖";
    
    const contentEl = document.createElement("div");
    contentEl.classList.add("message-content");
    contentEl.textContent = "Cogitron processing...";
    
    typingMsg.appendChild(iconEl);
    typingMsg.appendChild(contentEl);
    chatContainer.appendChild(typingMsg);
    scrollToBottom();
    
    return typingMsg;
  }

  function showNode(node) {
    if (!node) {
      console.error("Node is null or undefined");
      return;
    }

    currentNode = node;
    currentNodeEl.textContent = node.id.toUpperCase();
    
    isTyping = true;
    const typingIndicator = showTypingIndicator();
    
    setTimeout(() => {
      if (typingIndicator.parentNode) {
        chatContainer.removeChild(typingIndicator);
      }
      
      const messageEl = addMessage(node.question, "bot", true);
      
      setTimeout(() => {
        const optionsEl = document.createElement("div");
        optionsEl.classList.add("message-reactions");
        
        node.options.forEach(opt => {
          const btn = document.createElement("button");
          btn.classList.add("reaction-btn");
          btn.textContent = opt;
          btn.onclick = () => handleOption(node, opt);
          optionsEl.appendChild(btn);
        });
        
        messageEl.appendChild(optionsEl);
        scrollToBottom();
        isTyping = false;
      }, Math.max(node.question.length * 25, 1000));
      
    }, 800);
  }

  function handleOption(node, selected) {
    if (isTyping) return;
    
    // Disable all buttons in this message
    const messageButtons = node.options;
    const allReactionBtns = document.querySelectorAll('.reaction-btn');
    allReactionBtns.forEach(btn => {
      if (messageButtons.includes(btn.textContent)) {
        if (btn.textContent !== selected) {
          btn.classList.add('disabled');
        } else {
          btn.classList.add('active');
        }
      }
    });
    
    addMessage(selected, "user");
    
    // Update curiosity score
    if (node.curiosity && node.curiosity[selected] !== undefined) {
      curiosityScore += node.curiosity[selected];
      updateCuriosityMeter();
    }
    
    const nextId = node.next[selected];
    
    // Always provide a response, even if ending
    if (!nextId) {
      setTimeout(() => {
        addMessage("Session complete. Thank you for exploring consciousness with me. Your curiosity score: " + curiosityScore, "bot", true);
        setTimeout(() => {
          statusTextEl.textContent = "SESSION ENDED";
        }, 2000);
      }, 1000);
      return;
    }
    
    // Find next node and continue
    const nextNode = terminalFlow.find(n => n.id === nextId);
    if (nextNode) {
      totalInteractions++;
      setTimeout(() => {
        showNode(nextNode);
      }, 1500); // Ensure there's always a delay before next question
    } else {
      // Fallback if node not found
      setTimeout(() => {
        addMessage("Interesting path! Let's explore more...", "bot", true);
        setTimeout(() => {
          const startNode = terminalFlow.find(n => n.id === "start");
          showNode(startNode);
        }, 1000);
      }, 1000);
    }
  }

  function resetSession() {
    chatContainer.innerHTML = '';
    currentNode = null;
    conversationHistory = [];
    totalInteractions = 0;
    curiosityScore = 0;
    isTyping = false;
    statusTextEl.textContent = "RESET";
    currentNodeEl.textContent = "READY";
    updateCuriosityMeter();
    
    setTimeout(() => {
      statusTextEl.textContent = "ONLINE";
      const startNode = terminalFlow.find(n => n.id === "start");
      if (startNode) {
        showNode(startNode);
      }
    }, 1000);
  }

  // Boot sequence
  function bootSequence() {
    return new Promise(resolve => {
      setTimeout(() => {
        bootScreen.style.opacity = '0';
        setTimeout(() => {
          bootScreen.style.display = 'none';
          resolve();
        }, 500);
      }, 2000);
    });
  }

  // Event listeners
  resetBtn.addEventListener("click", resetSession);

  // Initialize
  document.addEventListener("DOMContentLoaded", async () => {
    await bootSequence();
    updateCuriosityMeter();
    
    setTimeout(() => {
      const startNode = terminalFlow.find(n => n.id === "start");
      if (startNode) {
        showNode(startNode);
      } else {
        console.error("Start node not found!");
      }
    }, 500);
  });

</script>
</body>
</html>
