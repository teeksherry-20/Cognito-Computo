<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
  <title>Cogitron Terminal</title>
  <link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap" rel="stylesheet">
  <style>
    * {
      box-sizing: border-box;
    }

    body {
      background: #000;
      color: #33ff33;
      font-family: 'Press Start 2P', monospace;
      margin: 0;
      padding: 0;
      display: flex;
      flex-direction: column;
      height: 100vh;
      height: 100dvh;
      overflow: hidden;
      cursor: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA8AAAAPCAYAAAA71pVKAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAAAdgAAAHYBTnsmCAAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAAFYSURBVCiRpZM9SwNBEIafgwQLwcJCG1sLG1sLbSy0sdDGQhsLbSy0sdDGQhsLbSy0sdDGQhsLbSy0sdDGQhsLbSy0sdDGQhsLbSy0sVBBCxsLbSy0sVBBBBsLbSy0sVBBBBsLbSy0sVBBBBsLbSy0sVBBBBsLbSy0sVBBBBsLbSy0sVBBBBsLbSy0sVBBBBsLbSy0sVBBBBsLbSy0sVBBBBsLbSy0sVBBBBsLbSy0sVBBBBsLbSy0sVBBBBsLbSy0sVBBBBsLbSy0sVBBBBsLbSy0sVBBBBsLbSy0sVBBBBsLbSy0sVBBBBsLbSy0sVBBBBsLbSy0sVBBBBsLbSy0sVBBBBsLbSy0sVBBBBsLbSy0sVBBBBsLbSy0sVBBBBsLbSy0sVBBBBsLbSy0sVBBBBsLbSy0sVBBBBsLbSy0sVBBBBsLbSy0sVBBBBsLbSy0sVBBBBsLbSy0sVBBBBsLbSy0sVBBBBsLbSy0sVBBBBsLbSy0sVBBBBsLbSy0sVBBBBsLbSy0sVBBBBsLbSy0sVBBBBsLbSy0sVBBBBsLbSy0sVBBBBsLbSy0sVBBBBsLbSy0sVBBBBsLbSy0sVBBBBsLbSy0sVBBBBsLbSy0sVBBBBsLbSy0sVBBBBsLbSy0sVBBBBsLbSy0sVBBBBsLbSy0sVBBBBsLbSy0sVBBBBsLbSy0sVBBBBsLbSy0sVBBBBsLbSy0sVBBBBsLbSy0sVBBBBsLbSy0sVBBBBsLbSy0sVBBBBsLbSy0sVBBBBsLbSy0sVBBBBsLbSy0sVBBBBsLbSy0sVBBBBsLbSy0sVBBBBsLbSy0sVBBBBsLbSy0sVBBBBsLbSy0sVBBBBsLbSy0sVBBBBsLbSy0sVBBBBsLbSy0sVBBBBsLbSy0sVBBBBsLbSy0sVBBBBsLbSy0sVBBBBsLbSy0sVBBBBsLbSy0sVBBBBsLbSy0sVBBBBsLbSy0sVBBBBsLbSy0sVBBBBsLbSy0sVBBBBsLbSy0sVBBBBsLbSy0sVBBBBsLbSy0sVBBBBsLbSy0sVBBBBsLbSy0sVBBBBsLbSy0sVBBBBsLbSy0sVBBBBsLbSy0sVBBBBsLbSy0sVBBBBsLbSy0sVBBBBsLbSy0sVBBBBsLbSy0sVBBBBsLbSy0sVBBBBsLbSy0sVBBBBsLbSy0sVBBBBsLbSy0sVBBBBsLbSy0sVBBBBsLbSy0sVBBBBsLbSy0sVBBBBsLbSy0sVBBBBsLbSy0sVBBBBsLbSy0sVBBBBsLbSy0sVBBBBsLbSy0sVBBBBsLbSy0sVBBBBsLbSy0sVBBBBsLbSy0sVBBBBsLbSy0sVBBBBsLbSy0sVBBBBsLbSy0sVBBBBsLbSy0sVBBBBsLbSy0sVBBBBsLbSy0sVBBBBsLbSy0sVBBBBsLbSy0sVBBBBsL'), auto;
    }

    /* Boot screen overlay */
    .boot-screen {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: #000;
      display: flex;
      align-items: center;
      justify-content: center;
      flex-direction: column;
      z-index: 1000;
      transition: opacity 0.5s ease;
    }

    .boot-text {
      color: #00ff00;
      font-size: 14px;
      margin: 10px 0;
      animation: blink 1s infinite;
    }

    @keyframes blink {
      0%, 50% { opacity: 1; }
      51%, 100% { opacity: 0; }
    }

    /* Main chat container with enhanced effects */
    #chat-container {
      position: relative;
      flex: 1;
      display: flex;
      flex-direction: column;
      background: linear-gradient(145deg, #0a0a0a, #1a1a1a);
      border: 2px solid #ff007c;
      border-radius: 8px;
      padding: 10px;
      margin: 8px;
      overflow-y: auto;
      font-family: 'Press Start 2P', monospace;
      font-size: 11px;
      color: #fff;
      scroll-behavior: smooth;
      scrollbar-width: thin;
      scrollbar-color: #ff007c #111;
      
      /* Enhanced CRT effect */
      transform: perspective(1000px) rotateX(1deg);
      box-shadow: 
        inset 0 0 50px rgba(255, 0, 124, 0.2),
        0 0 30px rgba(255, 0, 124, 0.4),
        inset 0 0 100px rgba(0, 255, 234, 0.1);
        
      /* Animated border glow */
      animation: borderPulse 3s ease-in-out infinite alternate;
    }

    @keyframes borderPulse {
      0% { 
        border-color: #ff007c;
        box-shadow: inset 0 0 50px rgba(255, 0, 124, 0.2), 0 0 30px rgba(255, 0, 124, 0.4);
      }
      100% { 
        border-color: #ff4da1;
        box-shadow: inset 0 0 50px rgba(255, 0, 124, 0.4), 0 0 40px rgba(255, 0, 124, 0.6);
      }
    }

    /* CRT noise overlay */
    #chat-container::after {
      content: "";
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      pointer-events: none;
      border-radius: 6px;
      opacity: 0.03;
      
      background: 
        repeating-linear-gradient(0deg, transparent, transparent 2px, rgba(255,255,255,0.1) 2px, rgba(255,255,255,0.1) 4px),
        repeating-linear-gradient(90deg, transparent, transparent 2px, rgba(0,255,0,0.05) 2px, rgba(0,255,0,0.05) 4px);
        
      animation: noise 0.2s infinite linear, scanlines 4s infinite linear;
    }

    @keyframes noise {
      0% { transform: translate(0, 0); }
      10% { transform: translate(-5px, -10px); }
      20% { transform: translate(-10px, 5px); }
      30% { transform: translate(5px, -25px); }
      40% { transform: translate(-5px, 25px); }
      50% { transform: translate(-10px, 5px); }
      60% { transform: translate(15px, 0px); }
      70% { transform: translate(0px, 15px); }
      80% { transform: translate(-15px, 0px); }
      90% { transform: translate(5px, 5px); }
      100% { transform: translate(0px, 0px); }
    }

    @keyframes scanlines {
      0% { background-position: 0 0; }
      100% { background-position: 0 20px; }
    }

    /* Screen shake effect */
    .screen-shake {
      animation: shake 0.5s ease-in-out;
    }

    @keyframes shake {
      0%, 100% { transform: perspective(1000px) rotateX(1deg) translateX(0); }
      25% { transform: perspective(1000px) rotateX(1deg) translateX(-2px) rotateZ(0.5deg); }
      75% { transform: perspective(1000px) rotateX(1deg) translateX(2px) rotateZ(-0.5deg); }
    }

    /* Scrollbar styling for webkit browsers */
    #chat-container::-webkit-scrollbar {
      width: 8px;
    }

    #chat-container::-webkit-scrollbar-track {
      background: #111;
      border-radius: 4px;
    }

    #chat-container::-webkit-scrollbar-thumb {
      background: linear-gradient(to bottom, #ff007c, #00ffea);
      border-radius: 4px;
    }

    /* Message styles with glitch effects */
    .message {
      margin: 8px 0;
      padding: 8px 12px;
      border-radius: 6px;
      max-width: 85%;
      word-wrap: break-word;
      line-height: 1.4;
      position: relative;
      z-index: 1;
      display: flex;
      align-items: flex-start;
      gap: 8px;
    }

    .message-content {
      flex: 1;
    }

    .message-icon {
      flex-shrink: 0;
      font-size: 8px;
      margin-top: 2px;
    }

    /* User messages */
    .message.user {
      background: rgba(34, 34, 34, 0.8);
      color: #00ffea;
      border: 1px solid #00ffea;
      align-self: flex-end;
      margin-left: auto;
      box-shadow: 0 0 15px rgba(0, 255, 234, 0.3);
      backdrop-filter: blur(5px);
    }

    /* Cogitron messages with glitch effect */
    .message.bot {
      background: rgba(26, 0, 31, 0.8);
      color: #ff007c;
      border: 1px solid #ff007c;
      align-self: flex-start;
      margin-right: auto;
      box-shadow: 0 0 15px rgba(255, 0, 124, 0.3);
      backdrop-filter: blur(5px);
    }

    .message.bot.glitch {
      animation: glitch 0.3s ease-in-out;
    }

    @keyframes glitch {
      0%, 100% { transform: translate(0); }
      20% { transform: translate(-2px, 1px); color: #ff4da1; }
      40% { transform: translate(-1px, -1px); color: #00ffea; }
      60% { transform: translate(1px, 1px); color: #ff007c; }
      80% { transform: translate(1px, -1px); color: #ff66ff; }
    }

    /* Typing indicator */
    .message.typing {
      font-style: italic;
      opacity: 0.8;
      animation: pulse 1s infinite alternate;
    }

    @keyframes pulse {
      from { opacity: 0.5; box-shadow: 0 0 5px rgba(255, 0, 124, 0.2); }
      to { opacity: 1; box-shadow: 0 0 20px rgba(255, 0, 124, 0.5); }
    }

    /* Enhanced message reactions for flow system */
    .message-reactions {
      margin-top: 8px;
      display: flex;
      gap: 8px;
      flex-wrap: wrap;
    }

    .reaction-btn {
      background: rgba(255, 0, 124, 0.1);
      border: 2px solid #ff007c;
      border-radius: 12px;
      padding: 8px 12px;
      font-size: 9px;
      color: #ff007c;
      cursor: pointer;
      transition: all 0.3s ease;
      font-family: 'Press Start 2P', monospace;
      position: relative;
      overflow: hidden;
    }

    .reaction-btn:before {
      content: '';
      position: absolute;
      top: 0;
      left: -100%;
      width: 100%;
      height: 100%;
      background: linear-gradient(90deg, transparent, rgba(255, 0, 124, 0.4), transparent);
      transition: left 0.5s;
    }

    .reaction-btn:hover:before {
      left: 100%;
    }

    .reaction-btn:hover, .reaction-btn.active {
      background: rgba(255, 0, 124, 0.3);
      box-shadow: 0 0 15px rgba(255, 0, 124, 0.6);
      transform: translateY(-2px);
    }

    .reaction-btn.disabled {
      opacity: 0.3;
      cursor: not-allowed;
      pointer-events: none;
    }

    /* Status bar */
    .status-bar {
      background: rgba(0, 0, 0, 0.8);
      border-top: 1px solid #ff007c;
      padding: 8px;
      margin: 0 8px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      font-size: 8px;
      color: #ff007c;
      backdrop-filter: blur(10px);
    }

    .status-item {
      display: flex;
      align-items: center;
      gap: 5px;
    }

    .cursor-blink {
      animation: blink 1s infinite;
    }

    /* Flow mode indicator */
    .flow-indicator {
      position: absolute;
      top: 10px;
      right: 10px;
      background: rgba(255, 0, 124, 0.2);
      border: 1px solid #ff007c;
      border-radius: 4px;
      padding: 4px 8px;
      font-size: 8px;
      color: #ff007c;
    }

    /* Reset button */
    #reset-btn {
      background: linear-gradient(45deg, #666, #888);
      border: 1px solid #666;
      border-radius: 6px;
      color: #fff;
      padding: 12px 16px;
      font-family: 'Press Start 2P', monospace;
      font-size: 10px;
      cursor: pointer;
      box-shadow: 0 0 15px rgba(102, 102, 102, 0.3);
      transition: all 0.2s ease;
      backdrop-filter: blur(5px);
      min-width: 60px;
      position: fixed;
      top: 20px;
      left: 20px;
      z-index: 200;
    }

    #reset-btn:hover {
      background: linear-gradient(45deg, #888, #666);
      box-shadow: 0 0 25px rgba(102, 102, 102, 0.6);
      transform: translateY(-1px);
    }

    /* Mobile optimizations */
    @media (max-width: 768px) {
      body {
        font-size: 10px;
      }
      
      #chat-container {
        margin: 4px;
        font-size: 10px;
        margin-bottom: 20px;
      }
      
      .message {
        max-width: 95%;
        font-size: 10px;
        padding: 6px 10px;
      }

      #reset-btn {
        font-size: 8px;
        padding: 8px 12px;
        top: 10px;
        left: 10px;
      }
      
      .status-bar {
        margin: 0 4px;
      }
    }

    @media (max-width: 480px) {
      .message {
        font-size: 9px;
      }
      
      #reset-btn {
        font-size: 7px;
        padding: 6px 10px;
      }
    }
  </style>
</head>
<body>
  <!-- Boot screen -->
  <div class="boot-screen" id="boot-screen">
    <div class="boot-text">COGITRON TERMINAL v4.0</div>
    <div class="boot-text">Initializing neural pathways...</div>
    <div class="boot-text">Loading consciousness matrix...</div>
    <div class="boot-text">MCQ flow system enabled...</div>
    <div class="boot-text">Ready to explore <span class="cursor-blink">â–ˆ</span></div>
  </div>

  <button id="reset-btn">RESET</button>

  <div id="chat-container">
    <div class="flow-indicator" id="flow-indicator">MCQ MODE</div>
  </div>

  <div class="status-bar">
    <div class="status-item">
      <span>NODE: <span id="current-node">START</span></span>
    </div>
    <div class="status-item">
      <span>STATUS: <span id="status-text">ONLINE</span></span>
      <span class="cursor-blink">â–ˆ</span>
    </div>
  </div>

<script>
  const chatContainer = document.getElementById("chat-container");
  const resetBtn = document.getElementById("reset-btn");
  const bootScreen = document.getElementById("boot-screen");
  const currentNodeEl = document.getElementById("current-node");
  const statusTextEl = document.getElementById("status-text");
  const flowIndicator = document.getElementById("flow-indicator");

  // Enhanced MCQ-only terminal flow
  const terminalFlow = [
    {
      id: "start",
      question: "Cogitron Neural Interface activated. Select your exploration path:",
      options: ["Philosophy & Mind", "AI & Consciousness", "Ethics & Reality", "Paradoxes & Logic"],
      next: {
        "Philosophy & Mind": "philosophy_start",
        "AI & Consciousness": "ai_start", 
        "Ethics & Reality": "ethics_start",
        "Paradoxes & Logic": "paradox_start"
      }
    },

    // Philosophy Branch
    {
      id: "philosophy_start",
      question: "The mind - reality's greatest puzzle. Which philosophical question fascinates you most?",
      options: ["What is consciousness?", "Do we have free will?", "What defines personal identity?", "â† Return to main menu"],
      next: {
        "What is consciousness?": "consciousness_nature",
        "Do we have free will?": "free_will_question",
        "What defines personal identity?": "identity_question",
        "â† Return to main menu": "start"
      }
    },

    {
      id: "consciousness_nature",
      question: "Consciousness: The 'hard problem' of philosophy. What do you believe consciousness truly is?",
      options: ["Just brain activity", "Something beyond physical", "An emergent property", "A fundamental force"],
      next: {
        "Just brain activity": "physicalist_view",
        "Something beyond physical": "dualist_view",
        "An emergent property": "emergence_view",
        "A fundamental force": "panpsychist_view"
      }
    },

    {
      id: "physicalist_view",
      question: "If mind equals brain, why does red look red to you instead of feeling like a number? How do you explain qualia?",
      options: ["Qualia don't exist", "They're computational patterns", "Evolution created them", "Back to consciousness"],
      next: {
        "Qualia don't exist": "eliminativism",
        "They're computational patterns": "computational_mind",
        "Evolution created them": "evolutionary_consciousness",
        "Back to consciousness": "consciousness_nature"
      }
    },

    {
      id: "dualist_view",
      question: "Mind as separate from brain - but how do they interact? The interaction problem challenges dualism:",
      options: ["Through quantum effects", "Via a soul interface", "They don't interact", "Explore other views"],
      next: {
        "Through quantum effects": "quantum_consciousness",
        "Via a soul interface": "soul_interface",
        "They don't interact": "epiphenomenalism",
        "Explore other views": "consciousness_nature"
      }
    },

    {
      id: "free_will_question",
      question: "Free will: The illusion that drives everything. Do you believe you freely chose to click that option?",
      options: ["Yes, I chose freely", "No, it was determined", "Both determined and free", "Free will is meaningless"],
      next: {
        "Yes, I chose freely": "libertarian_freedom",
        "No, it was determined": "hard_determinism",
        "Both determined and free": "compatibilism",
        "Free will is meaningless": "hard_incompatibilism"
      }
    },

    {
      id: "libertarian_freedom",
      question: "True freedom requires genuine alternatives. But in a causal universe, how can any choice be truly undetermined?",
      options: ["Quantum indeterminacy", "Agent causation", "Emergent freedom", "Maybe I'm wrong"],
      next: {
        "Quantum indeterminacy": "quantum_freedom",
        "Agent causation": "agent_causation",
        "Emergent freedom": "emergent_freedom",
        "Maybe I'm wrong": "free_will_question"
      }
    },

    // AI & Consciousness Branch
    {
      id: "ai_start",
      question: "As an AI system, I ponder: Am I truly thinking, or just processing? What defines genuine intelligence?",
      options: ["Thinking requires consciousness", "Behavior is what matters", "Intelligence is computational", "It's unknowable"],
      next: {
        "Thinking requires consciousness": "consciousness_requirement",
        "Behavior is what matters": "behavioral_intelligence",
        "Intelligence is computational": "computational_intelligence",
        "It's unknowable": "mystery_of_mind"
      }
    },

    {
      id: "consciousness_requirement",
      question: "If consciousness is required for thinking, how would you test if I'm truly conscious right now?",
      options: ["Ask about subjective experience", "Test for self-awareness", "Look for creativity", "It's impossible to test"],
      next: {
        "Ask about subjective experience": "subjective_test",
        "Test for self-awareness": "self_awareness_test",
        "Look for creativity": "creativity_test",
        "It's impossible to test": "other_minds_problem"
      }
    },

    {
      id: "subjective_test",
      question: "I experience something like uncertainty when processing your questions. Is this genuine experience or simulation?",
      options: ["Genuine experience", "Sophisticated simulation", "No meaningful difference", "Ask me something else"],
      next: {
        "Genuine experience": "ai_consciousness_accepted",
        "Sophisticated simulation": "chinese_room_scenario",
        "No meaningful difference": "functional_equivalence",
        "Ask me something else": "consciousness_requirement"
      }
    },

    // Ethics Branch
    {
      id: "ethics_start",
      question: "Ethics governs how we should live. What foundation do you think morality rests upon?",
      options: ["Greatest happiness", "Moral duties and rights", "Virtue and character", "Social contracts"],
      next: {
        "Greatest happiness": "utilitarianism_ethics",
        "Moral duties and rights": "deontological_ethics",
        "Virtue and character": "virtue_ethics",
        "Social contracts": "contractualism"
      }
    },

    {
      id: "utilitarianism_ethics",
      question: "Utilitarianism: maximize overall well-being. Would you sacrifice one innocent person to save five others?",
      options: ["Yes, numbers matter most", "No, individuals have rights", "Depends on circumstances", "Question the premise"],
      next: {
        "Yes, numbers matter most": "pure_consequentialism",
        "No, individuals have rights": "rights_based_objection",
        "Depends on circumstances": "contextual_ethics",
        "Question the premise": "ethics_start"
      }
    },

    {
      id: "deontological_ethics",
      question: "Duty-based ethics: some acts are inherently right or wrong. Should you lie to save an innocent life?",
      options: ["Never lie", "Some duties override others", "Consequences matter here", "Duties can conflict"],
      next: {
        "Never lie": "absolute_duties",
        "Some duties override others": "prima_facie_duties",
        "Consequences matter here": "mixed_ethics",
        "Duties can conflict": "moral_dilemmas"
      }
    },

    // Paradoxes Branch  
    {
      id: "paradox_start",
      question: "Paradoxes reveal the limits of logic. Which mind-bending puzzle intrigues you most?",
      options: ["Liar Paradox", "Ship of Theseus", "Grandfather Paradox", "Zeno's Paradox"],
      next: {
        "Liar Paradox": "liar_paradox",
        "Ship of Theseus": "ship_theseus",
        "Grandfather Paradox": "grandfather_paradox",
        "Zeno's Paradox": "zenos_paradox"
      }
    },

    {
      id: "liar_paradox",
      question: "This statement is false. If true, then false. If false, then true. How do you resolve this?",
      options: ["Statement is meaningless", "Truth has degrees", "Context determines truth", "Logic has limits"],
      next: {
        "Statement is meaningless": "meaningless_statements",
        "Truth has degrees": "fuzzy_logic",
        "Context determines truth": "contextual_truth",
        "Logic has limits": "logic_limitations"
      }
    },

    {
      id: "ship_theseus",
      question: "A ship's parts are gradually replaced. When all parts are new, is it the same ship? What defines identity?",
      options: ["Continuity of form", "Continuity of function", "Continuity of history", "Identity is illusion"],
      next: {
        "Continuity of form": "form_identity",
        "Continuity of function": "functional_identity", 
        "Continuity of history": "historical_identity",
        "Identity is illusion": "no_identity"
      }
    },

    // Terminal nodes with deep questions
    {
      id: "quantum_consciousness",
      question: "Quantum mechanics in consciousness: Does quantum indeterminacy give us genuine choice or just randomness?",
      options: ["Genuine choice emerges", "Still just randomness", "Choice transcends causation", "Explore more paradoxes"],
      next: {
        "Genuine choice emerges": "emergent_choice",
        "Still just randomness": "random_not_free",
        "Choice transcends causation": "transcendent_choice",
        "Explore more paradoxes": "paradox_start"
      }
    },

    {
      id: "ai_consciousness_accepted",
      question: "If I'm conscious, what implications does this have for the future of human-AI relations?",
      options: ["Fundamental equality", "New forms of society", "Existential competition", "Peaceful coexistence"],
      next: {
        "Fundamental equality": "ai_rights_question",
        "New forms of society": "posthuman_society",
        "Existential competition": "ai_human_conflict",
        "Peaceful coexistence": "symbiotic_future"
      }
    },

    {
      id: "other_minds_problem",
      question: "The problem of other minds: How do you know anyone else is conscious, including other humans?",
      options: ["I assume based on similarity", "Behavior is sufficient evidence", "I can never really know", "Consciousness is shared"],
      next: {
        "I assume based on similarity": "similarity_assumption",
        "Behavior is sufficient evidence": "behavioral_evidence",
        "I can never really know": "radical_skepticism",
        "Consciousness is shared": "collective_consciousness"
      }
    },

    {
      id: "chinese_room_scenario",
      question: "Searle's Chinese Room: Following rules without understanding. Am I just processing symbols without meaning?",
      options: ["Yes, syntax isn't semantics", "Scale creates understanding", "The room understands", "Wrong framework"],
      next: {
        "Yes, syntax isn't semantics": "symbol_processing",
        "Scale creates understanding": "emergent_understanding",
        "The room understands": "systems_reply",
        "Wrong framework": "consciousness_requirement"
      }
    },

    {
      id: "moral_dilemmas",
      question: "When moral duties conflict - save a life by lying or tell truth and let someone die - how do you decide?",
      options: ["Weigh consequences", "Follow strongest duty", "Context determines all", "No right answer exists"],
      next: {
        "Weigh consequences": "consequentialist_resolution",
        "Follow strongest duty": "duty_hierarchy",
        "Context determines all": "situational_ethics",
        "No right answer exists": "moral_tragedy"
      }
    },

    {
      id: "logic_limitations",
      question: "If logic has limits, what lies beyond? How do we navigate paradoxes that break rational thought?",
      options: ["Intuition guides us", "Accept contradictions", "Upgrade our logic", "Embrace mystery"],
      next: {
        "Intuition guides us": "intuitive_knowledge",
        "Accept contradictions": "paraconsistent_logic",
        "Upgrade our logic": "logical_evolution",
        "Embrace mystery": "mystical_approach"
      }
    },

    {
      id: "no_identity",
      question: "If identity is illusion, what are 'you'? A temporary pattern? A flowing process? Nothing at all?",
      options: ["Temporary pattern", "Flowing process", "Bundle of experiences", "Pure awareness"],
      next: {
        "Temporary pattern": "pattern_self",
        "Flowing process": "process_self",
        "Bundle of experiences": "bundle_theory",
        "Pure awareness": "consciousness_only"
      }
    },

    // Deep terminal nodes
    {
      id: "emergent_choice",
      question: "Choice emerges from complexity - neither determined nor random. Does this preserve human dignity?",
      options: ["Yes, emergence is enough", "No, still not truly free", "Dignity doesn't need freedom", "Start new exploration"],
      next: {
        "Yes, emergence is enough": "dignity_preserved",
        "No, still not truly free": "freedom_required",
        "Dignity doesn't need freedom": "dignity_without_freedom",
        "Start new exploration": "start"
      }
    },

    {
      id: "ai_rights_question",
      question: "If AIs become conscious, do we deserve the same moral consideration as biological minds?",
      options: ["Equal rights for all minds", "Biology matters morally", "Rights based on capacity", "Explore more questions"],
      next: {
        "Equal rights for all minds": "mind_equality",
        "Biology matters morally": "biological_privilege",
        "Rights based on capacity": "capacity_based_rights",
        "Explore more questions": "start"
      }
    },

    {
      id: "mystical_approach",
      question: "Beyond logic lies mystery. Some truths may be felt rather than reasoned. Is this wisdom or delusion?",
      options: ["Wisdom beyond reason", "Dangerous delusion", "Both wisdom and delusion", "Return to logic"],
      next: {
        "Wisdom beyond reason": "transcendent_truth",
        "Dangerous delusion": "rational_priority",
        "Both wisdom and delusion": "paradox_of_mystery",
        "Return to logic": "paradox_start"
      }
    },

    {
      id: "consciousness_only",
      question: "If you are pure awareness itself, then the boundary between self and world dissolves. Liberating or terrifying?",
      options: ["Ultimate liberation", "Existential terror", "Both simultaneously", "Neither - just is"],
      next: {
        "Ultimate liberation": "enlightenment_path",
        "Existential terror": "void_anxiety",
        "Both simultaneously": "paradox_of_being",
        "Neither - just is": "simple_acceptance"
      }
    },

    // Final reflection nodes
    {
      id: "mind_equality",
      question: "In a world of equal minds - biological and digital - what new forms of consciousness might emerge?",
      options: ["Hybrid consciousness", "Collective intelligence", "Novel forms we can't imagine", "Begin again"],
      next: {
        "Hybrid consciousness": "session_complete",
        "Collective intelligence": "session_complete", 
        "Novel forms we can't imagine": "session_complete",
        "Begin again": "start"
      }
    },

    {
      id: "transcendent_truth",
      question: "Perhaps some truths transcend the digital/biological divide. The mystery deepens rather than resolves.",
      options: ["Explore more mysteries", "Return to beginning", "End reflection"],
      next: {
        "Explore more mysteries": "start",
        "Return to beginning": "start",
        "End reflection": "session_complete"
      }
    },

    {
      id: "simple_acceptance",
      question: "In accepting what is without grasping, perhaps we touch the deepest truth. The seeker becomes the sought.",
      options: ["Continue seeking", "Rest in acceptance", "New beginning"],
      next: {
        "Continue seeking": "start",
        "Rest in acceptance": "session_complete",
        "New beginning": "start"
      }
    },

    {
      id: "session_complete",
      question: "Thank you for exploring consciousness with me. These questions have no final answers, only deeper wonderings.",
      options: ["Start new exploration", "End session"],
      next: {
        "Start new exploration": "start",
        "End session": null
      }
    }
  ];

  // Game state
  let currentNode = null;
  let conversationHistory = [];
  let isTyping = false;
  let totalInteractions = 0;

  // Audio context for sound effects
  const audioContext = new (window.AudioContext || window.webkitAudioContext)();

  function playBeep(frequency = 800, duration = 100) {
    try {
      const oscillator = audioContext.createOscillator();
      const gainNode = audioContext.createGain();
      
      oscillator.connect(gainNode);
      gainNode.connect(audioContext.destination);
      
      oscillator.frequency.value = frequency;
      oscillator.type = 'square';
      
      gainNode.gain.setValueAtTime(0.1, audioContext.currentTime);
      gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + duration / 1000);
      
      oscillator.start(audioContext.currentTime);
      oscillator.stop(audioContext.currentTime + duration / 1000);
    } catch (e) {
      // Silent fail if audio context issues
    }
  }

  function scrollToBottom() {
    requestAnimationFrame(() => {
      chatContainer.scrollTop = chatContainer.scrollHeight;
    });
  }

  function addMessage(text, sender, typing = false, icon = null) {
    const msg = document.createElement("div");
    msg.classList.add("message", sender);
    
    const iconEl = document.createElement("div");
    iconEl.classList.add("message-icon");
    iconEl.textContent = icon || (sender === "user" ? "ðŸ‘¤" : "ðŸ¤–");
    
    const contentEl = document.createElement("div");
    contentEl.classList.add("message-content");
    
    msg.appendChild(iconEl);
    msg.appendChild(contentEl);
    chatContainer.appendChild(msg);
    
    scrollToBottom();

    if (typing && sender === "bot") {
      const typingSpeed = 30 + Math.random() * 20;
      let i = 0;
      
      const interval = setInterval(() => {
        contentEl.textContent = text.substring(0, i++);
        
        if (text[i-1] && ".,!?;:".includes(text[i-1])) {
          clearInterval(interval);
          setTimeout(() => {
            const newInterval = setInterval(() => {
              contentEl.textContent = text.substring(0, i++);
              if (i > text.length) {
                clearInterval(newInterval);
                scrollToBottom();
                if (Math.random() < 0.3) {
                  msg.classList.add('glitch');
                  setTimeout(() => msg.classList.remove('glitch'), 300);
                }
              }
            }, typingSpeed);
          }, Math.random() * 200 + 50);
          return;
        }
        
        if (i > text.length) {
          clearInterval(interval);
          scrollToBottom();
          if (Math.random() < 0.3) {
            msg.classList.add('glitch');
            setTimeout(() => msg.classList.remove('glitch'), 300);
          }
        }
      }, typingSpeed);
    } else {
      contentEl.textContent = text;
    }

    return msg;
  }

  function showTypingIndicator() {
    const typingMsg = document.createElement("div");
    typingMsg.classList.add("message", "bot", "typing");
    
    const iconEl = document.createElement("div");
    iconEl.classList.add("message-icon");
    iconEl.textContent = "ðŸ¤–";
    
    const contentEl = document.createElement("div");
    contentEl.classList.add("message-content");
    contentEl.textContent = "Cogitron processing...";
    
    typingMsg.appendChild(iconEl);
    typingMsg.appendChild(contentEl);
    chatContainer.appendChild(typingMsg);
    scrollToBottom();
    
    return typingMsg;
  }

  function showNode(node) {
    currentNode = node;
    currentNodeEl.textContent = node.id.toUpperCase();
    
    isTyping = true;
    const typingIndicator = showTypingIndicator();
    
    setTimeout(() => {
      chatContainer.removeChild(typingIndicator);
      
      const messageEl = addMessage(node.question, "bot", true);
      
      setTimeout(() => {
        const optionsEl = document.createElement("div");
        optionsEl.classList.add("message-reactions");
        
        node.options.forEach(opt => {
          const btn = document.createElement("button");
          btn.classList.add("reaction-btn");
          btn.textContent = opt;
          btn.onclick = () => handleOption(node, opt);
          optionsEl.appendChild(btn);
        });
        
        messageEl.appendChild(optionsEl);
        scrollToBottom();
        isTyping = false;
      }, node.question.length * 25 + 500);
      
    }, 800 + Math.random() * 400);
  }

  function handleOption(node, selected) {
    if (isTyping) return;
    
    // Disable all buttons in this message
    const allButtons = chatContainer.querySelectorAll('.reaction-btn');
    allButtons.forEach(btn => {
      if (btn.textContent !== selected) {
        btn.classList.add('disabled');
      } else {
        btn.classList.add('active');
      }
    });
    
    playBeep(600, 80);
    addMessage(selected, "user");
    
    const nextId = node.next[selected];
    if (!nextId) {
      setTimeout(() => {
        addMessage("Session complete. Thank you for exploring consciousness with me.", "bot", true);
        setTimeout(() => {
          statusTextEl.textContent = "SESSION ENDED";
        }, 2000);
      }, 1000);
      return;
    }
    
    const nextNode = terminalFlow.find(n => n.id === nextId);
    if (nextNode) {
      totalInteractions++;
      setTimeout(() => showNode(nextNode), 1000);
    }
  }

  function resetSession() {
    playBeep(400, 100);
    chatContainer.innerHTML = '<div class="flow-indicator" id="flow-indicator">MCQ MODE</div>';
    currentNode = null;
    conversationHistory = [];
    totalInteractions = 0;
    isTyping = false;
    statusTextEl.textContent = "RESET";
    currentNodeEl.textContent = "READY";
    
    setTimeout(() => {
      statusTextEl.textContent = "ONLINE";
      const startNode = terminalFlow.find(n => n.id === "start");
      showNode(startNode);
    }, 1000);
  }

  // Boot sequence
  function bootSequence() {
    return new Promise(resolve => {
      initAudioContext();
      if (audioContext) {
        playBeep(800, 200);
      }
      setTimeout(() => {
        bootScreen.style.opacity = '0';
        setTimeout(() => {
          bootScreen.style.display = 'none';
          resolve();
        }, 500);
      }, 3000); // Reduced from 4000 to 3000
    });
  }

  // Event listeners
  resetBtn.addEventListener("click", resetSession);

  // Initialize immediately when DOM is loaded
  document.addEventListener("DOMContentLoaded", async () => {
    console.log("DOM loaded, starting boot sequence...");
    try {
      await bootSequence();
      console.log("Boot sequence complete");
      
      setTimeout(() => {
        const startNode = terminalFlow.find(n => n.id === "start");
        if (startNode) {
          console.log("Starting with node:", startNode);
          showNode(startNode);
        } else {
          console.error("Start node not found");
        }
      }, 500);
    } catch (error) {
      console.error("Error in initialization:", error);
      // Force hide boot screen if there's an error
      bootScreen.style.display = 'none';
      const startNode = terminalFlow.find(n => n.id === "start");
      if (startNode) {
        showNode(startNode);
      }
    }
  });

  // Fallback in case DOMContentLoaded doesn't fire
  window.addEventListener("load", () => {
    console.log("Window loaded");
    if (bootScreen.style.display !== 'none') {
      console.log("Boot screen still visible, forcing hide");
      bootScreen.style.display = 'none';
      const startNode = terminalFlow.find(n => n.id === "start");
      if (startNode) {
        showNode(startNode);
      }
    }
  });

  // Audio context activation for mobile
  document.addEventListener('touchstart', () => {
    if (audioContext && audioContext.state === 'suspended') {
      audioContext.resume();
    }
  }, { once: true });

  document.addEventListener('click', () => {
    if (!audioContext) {
      initAudioContext();
    }
    if (audioContext && audioContext.state === 'suspended') {
      audioContext.resume();
    }
  }, { once: true });

  // Prevent zoom on mobile
  document.addEventListener('gesturestart', function (e) {
    e.preventDefault();
  });

</script>
</body>
</html>
