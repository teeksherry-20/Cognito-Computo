<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
  <title>Cogitron Terminal</title>
  <link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap" rel="stylesheet">
  <style>
    * {
      box-sizing: border-box;
    }

    body {
      background: #000;
      color: #33ff33;
      font-family: 'Press Start 2P', monospace;
      margin: 0;
      padding: 0;
      display: flex;
      flex-direction: column;
      height: 100vh;
      overflow: hidden;
    }

    /* Boot screen overlay */
    .boot-screen {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: #000;
      display: flex;
      align-items: center;
      justify-content: center;
      flex-direction: column;
      z-index: 1000;
      transition: opacity 0.5s ease;
    }

    .boot-screen.hidden {
      opacity: 0;
      pointer-events: none;
    }

    .boot-text {
      color: #00ff00;
      font-size: 14px;
      margin: 10px 0;
      animation: blink 1s infinite;
    }

    @keyframes blink {
      0%, 50% { opacity: 1; }
      51%, 100% { opacity: 0; }
    }

    /* Main chat container */
    #chat-container {
      flex: 1;
      display: flex;
      flex-direction: column;
      background: #111;
      border: 2px solid #ff007c;
      border-radius: 8px;
      padding: 10px;
      margin: 8px;
      margin-bottom: 140px;
      overflow-y: auto;
      font-family: 'Press Start 2P', monospace;
      font-size: 11px;
      color: #fff;
      scroll-behavior: smooth;
      position: relative;
    }

    /* Scrollbar styling */
    #chat-container::-webkit-scrollbar {
      width: 8px;
    }

    #chat-container::-webkit-scrollbar-track {
      background: #222;
      border-radius: 4px;
    }

    #chat-container::-webkit-scrollbar-thumb {
      background: #ff007c;
      border-radius: 4px;
    }

    /* Message styles */
    .message {
      margin: 12px 0;
      padding: 8px 12px;
      border-radius: 6px;
      max-width: 85%;
      word-wrap: break-word;
      line-height: 1.5;
      display: flex;
      align-items: flex-start;
      gap: 8px;
      animation: messageAppear 0.3s ease-out;
    }

    @keyframes messageAppear {
      0% { opacity: 0; transform: translateY(10px); }
      100% { opacity: 1; transform: translateY(0); }
    }

    .message-content {
      flex: 1;
    }

    .message-icon {
      flex-shrink: 0;
      font-size: 8px;
      margin-top: 2px;
    }

    /* User messages */
    .message.user {
      background: rgba(34, 34, 34, 0.8);
      color: #00ffea;
      border: 1px solid #00ffea;
      align-self: flex-end;
      margin-left: auto;
      box-shadow: 0 0 5px rgba(0, 255, 234, 0.3);
    }

    /* Cogitron messages */
    .message.bot {
      background: rgba(26, 0, 31, 0.8);
      color: #ff007c;
      border: 1px solid #ff007c;
      align-self: flex-start;
      margin-right: auto;
      box-shadow: 0 0 5px rgba(255, 0, 124, 0.3);
    }

    /* Typing indicator */
    .message.typing {
      font-style: italic;
      opacity: 0.8;
      animation: pulse 1.5s infinite alternate;
    }

    @keyframes pulse {
      from { opacity: 0.4; }
      to { opacity: 1; }
    }

    /* Enhanced typing cursor */
    .typing-cursor {
      display: inline-block;
      width: 8px;
      height: 12px;
      background: #ff007c;
      animation: cursorBlink 1s infinite;
      margin-left: 2px;
    }

    @keyframes cursorBlink {
      0%, 50% { opacity: 1; }
      51%, 100% { opacity: 0; }
    }

    /* Message reactions - enhanced with hover effects */
    .message-reactions {
      margin-top: 15px;
      display: flex;
      gap: 10px;
      flex-wrap: wrap;
      clear: both;
    }

    .reaction-btn {
      background: rgba(255, 0, 124, 0.1);
      border: 2px solid #ff007c;
      border-radius: 8px;
      padding: 10px 14px;
      font-size: 9px;
      color: #ff007c;
      cursor: pointer;
      transition: all 0.3s ease;
      font-family: 'Press Start 2P', monospace;
      margin: 2px;
      min-height: 36px;
      display: flex;
      align-items: center;
      position: relative;
      overflow: hidden;
      user-select: none;
    }

    .reaction-btn::before {
      content: '';
      position: absolute;
      top: 0;
      left: -100%;
      width: 100%;
      height: 100%;
      background: linear-gradient(90deg, transparent, rgba(255, 0, 124, 0.4), transparent);
      transition: left 0.5s ease;
    }

    .reaction-btn:hover:not(.disabled) {
      background: rgba(255, 0, 124, 0.3);
      transform: translateY(-2px);
      box-shadow: 
        0 4px 8px rgba(255, 0, 124, 0.4),
        0 0 15px rgba(255, 0, 124, 0.6);
      text-shadow: 0 0 5px #ff007c;
    }

    .reaction-btn:hover:not(.disabled)::before {
      left: 100%;
    }

    .reaction-btn:active:not(.disabled) {
      transform: translateY(0);
      transition: transform 0.1s ease;
    }

    .reaction-btn.active {
      background: rgba(255, 0, 124, 0.5);
      color: #fff;
      box-shadow: 0 0 20px rgba(255, 0, 124, 0.8);
      text-shadow: 0 0 5px #fff;
      pointer-events: none;
    }

    .reaction-btn.disabled {
      opacity: 0.3;
      cursor: not-allowed;
      pointer-events: none;
    }

    /* Session Summary Styles */
    .session-summary {
      background: rgba(0, 0, 0, 0.95);
      border: 2px solid #ff007c;
      border-radius: 12px;
      padding: 20px;
      margin: 20px 0;
      text-align: center;
      animation: summaryAppear 0.5s ease-out;
    }

    @keyframes summaryAppear {
      0% { opacity: 0; transform: scale(0.9); }
      100% { opacity: 1; transform: scale(1); }
    }

    .summary-header {
      color: #ff007c;
      font-size: 12px;
      margin-bottom: 15px;
      text-transform: uppercase;
      letter-spacing: 2px;
    }

    .profile-title {
      font-size: 14px;
      margin: 15px 0;
      text-shadow: 0 0 10px currentColor;
      animation: profileGlow 2s ease-in-out infinite alternate;
    }

    @keyframes profileGlow {
      0% { text-shadow: 0 0 5px currentColor; }
      100% { text-shadow: 0 0 15px currentColor, 0 0 25px currentColor; }
    }

    .profile-description {
      color: #fff;
      font-size: 9px;
      line-height: 1.6;
      margin: 15px 0;
      padding: 15px;
      background: rgba(255, 255, 255, 0.05);
      border-radius: 8px;
    }

    .curiosity-final-score {
      font-size: 16px;
      margin: 20px 0;
      color: #00ffea;
      text-shadow: 0 0 10px #00ffea;
    }

    .profile-traits {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 10px;
      margin: 20px 0;
    }

    .trait {
      background: rgba(255, 0, 124, 0.1);
      border: 1px solid #ff007c;
      border-radius: 6px;
      padding: 8px;
      font-size: 7px;
      color: #ff007c;
    }

    .summary-actions {
      margin-top: 20px;
      display: flex;
      gap: 15px;
      justify-content: center;
    }

    .summary-btn {
      background: linear-gradient(45deg, #ff007c, #ff6b00);
      border: none;
      border-radius: 8px;
      color: #fff;
      padding: 12px 20px;
      font-family: 'Press Start 2P', monospace;
      font-size: 8px;
      cursor: pointer;
      transition: all 0.3s ease;
      text-transform: uppercase;
    }

    .summary-btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 4px 12px rgba(255, 0, 124, 0.5);
    }

    .summary-btn.home-btn {
      background: linear-gradient(45deg, #00ffea, #0066cc);
    }

    /* Fixed bottom interface */
    .bottom-interface {
      position: fixed;
      bottom: 0;
      left: 0;
      right: 0;
      background: rgba(0, 0, 0, 0.95);
      border-top: 2px solid #ff007c;
      padding: 10px;
      z-index: 100;
      backdrop-filter: blur(5px);
    }

    /* Enhanced rank title display */
    .rank-title {
      background: rgba(255, 0, 124, 0.1);
      border: 1px solid #ff007c;
      border-radius: 6px;
      padding: 6px 10px;
      margin-bottom: 8px;
      text-align: center;
      font-size: 8px;
      color: #ff007c;
      text-transform: uppercase;
      letter-spacing: 1px;
      transition: all 0.3s ease;
    }

    /* Milestone glow effect - enhanced */
    .milestone-glow {
      animation: milestoneGlow 3s ease-in-out;
      box-shadow: 0 0 30px #ff007c;
    }

    @keyframes milestoneGlow {
      0% { box-shadow: 0 0 5px #ff007c; }
      25% { box-shadow: 0 0 40px #ff007c, 0 0 60px #00ffea; }
      50% { box-shadow: 0 0 50px #ff007c, 0 0 80px #00ffea, 0 0 100px #ff6b00; }
      75% { box-shadow: 0 0 40px #ff007c, 0 0 60px #00ffea; }
      100% { box-shadow: 0 0 5px #ff007c; }
    }

    /* Enhanced curiosity meter */
    .curiosity-meter {
      background: rgba(17, 17, 17, 0.9);
      border: 1px solid #00ffea;
      border-radius: 6px;
      padding: 8px;
      margin-bottom: 8px;
      display: flex;
      align-items: center;
      gap: 10px;
      transition: all 0.3s ease;
    }

    .meter-label {
      font-size: 8px;
      color: #00ffea;
      white-space: nowrap;
      text-shadow: 0 0 3px #00ffea;
    }

    .meter-bar {
      flex: 1;
      height: 8px;
      background: #222;
      border-radius: 4px;
      overflow: hidden;
      box-shadow: inset 0 0 5px rgba(0, 0, 0, 0.5);
    }

    .meter-fill {
      height: 100%;
      background: linear-gradient(90deg, #00ffea, #ff007c, #ff6b00);
      width: 0%;
      transition: width 0.8s ease;
      box-shadow: 0 0 10px rgba(0, 255, 234, 0.5);
    }

    .meter-score {
      font-size: 8px;
      color: #ff007c;
      white-space: nowrap;
      text-shadow: 0 0 3px #ff007c;
    }

    /* Status bar */
    .status-bar {
      background: rgba(0, 0, 0, 0.8);
      padding: 8px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      font-size: 8px;
      color: #ff007c;
      border-radius: 4px;
    }

    .status-item {
      display: flex;
      align-items: center;
      gap: 5px;
    }

    .cursor-blink {
      animation: blink 1s infinite;
    }

    /* Top buttons */
    .top-buttons {
      position: absolute;
      top: 10px;
      right: 10px;
      z-index: 200;
      display: flex;
      gap: 10px;
    }

    /* Enhanced reset and home buttons */
    .top-btn {
      background: linear-gradient(45deg, #666, #888);
      border: 1px solid #666;
      border-radius: 6px;
      color: #fff;
      padding: 8px 12px;
      font-family: 'Press Start 2P', monospace;
      font-size: 8px;
      cursor: pointer;
      transition: all 0.3s ease;
      text-transform: uppercase;
    }

    .top-btn:hover {
      background: linear-gradient(45deg, #888, #666);
      transform: translateY(-2px);
      box-shadow: 0 4px 8px rgba(255, 255, 255, 0.2);
    }

    .home-btn {
      background: linear-gradient(45deg, #00ffea, #0066cc);
      border: 1px solid #00ffea;
    }

    .home-btn:hover {
      background: linear-gradient(45deg, #0066cc, #00ffea);
    }

    /* Mobile optimizations */
    @media (max-width: 768px) {
      #chat-container {
        margin: 4px;
        font-size: 10px;
        margin-bottom: 160px;
      }
      
      .message {
        max-width: 95%;
        font-size: 10px;
        padding: 6px 10px;
      }

      .reaction-btn {
        font-size: 8px;
        padding: 8px 12px;
        min-height: 32px;
      }

      .top-btn {
        font-size: 7px;
        padding: 6px 10px;
      }

      .top-buttons {
        top: 5px;
        right: 5px;
      }

      .bottom-interface {
        padding: 8px;
      }

      .meter-label, .meter-score {
        font-size: 7px;
      }

      .profile-traits {
        grid-template-columns: 1fr;
      }

      .summary-actions {
        flex-direction: column;
        align-items: center;
      }
    }
  </style>
</head>
<body>
  <!-- Boot screen -->
  <div class="boot-screen" id="boot-screen">
    <div class="boot-text">COGITRON TERMINAL v4.2</div>
    <div class="boot-text">Initializing neural pathways...</div>
    <div class="boot-text">Loading consciousness matrix...</div>
    <div class="boot-text">Enhanced dialogue systems online...</div>
    <div class="boot-text">MCQ flow system enabled...</div>
    <div class="boot-text">Ready to explore <span class="cursor-blink">█</span></div>
  </div>

  <div class="top-buttons">
    <button id="home-btn" class="top-btn home-btn">Home</button>
    <button id="reset-btn" class="top-btn">Reset</button>
  </div>

  <div id="chat-container"></div>

  <div class="bottom-interface">
    <div class="rank-title" id="rank-title">NOVICE THINKER</div>
    <div class="curiosity-meter" id="curiosity-meter">
      <div class="meter-label">CURIOSITY:</div>
      <div class="meter-bar">
        <div class="meter-fill" id="curiosity-fill"></div>
      </div>
      <div class="meter-score" id="curiosity-score">0</div>
    </div>
    
    <div class="status-bar">
      <div class="status-item">
        <span>NODE: <span id="current-node">START</span></span>
      </div>
      <div class="status-item">
        <span>STATUS: <span id="status-text">ONLINE</span></span>
        <span class="cursor-blink">█</span>
      </div>
    </div>
  </div>

<script>
  // Game state variables
  let gameState = {
    currentNodeId: 'start',
    curiosityScore: 0,
    questionsAnswered: 0,
    currentRank: 'NOVICE THINKER',
    pathHistory: []
  };

  // DOM elements
  const chatContainer = document.getElementById("chat-container");
  const resetBtn = document.getElementById("reset-btn");
  const homeBtn = document.getElementById("home-btn");
  const bootScreen = document.getElementById("boot-screen");
  const currentNodeEl = document.getElementById("current-node");
  const statusTextEl = document.getElementById("status-text");
  const curiosityFill = document.getElementById("curiosity-fill");
  const curiosityScoreEl = document.getElementById("curiosity-score");
  const rankTitleEl = document.getElementById("rank-title");

  // Curiosity profiles based on score ranges
  const curiosityProfiles = [
    {
      min: 0, max: 29,
      title: "The Cautious Observer",
      description: "You approach philosophical questions with careful consideration, preferring to observe rather than dive deep into uncertainty. Your measured approach shows wisdom in recognizing the complexity of existence.",
      traits: ["Methodical thinking", "Risk-aware", "Practical wisdom", "Grounded perspective"],
      color: "#666666"
    },
    {
      min: 30, max: 59,
      title: "The Curious Seeker", 
      description: "Your mind is opening to philosophy's vast questions. You show genuine interest in exploring ideas while maintaining healthy skepticism. The journey of inquiry has begun.",
      traits: ["Growing curiosity", "Open-minded", "Question-driven", "Balanced inquiry"],
      color: "#00ffea"
    },
    {
      min: 60, max: 99,
      title: "The Deep Questioner",
      description: "You embrace philosophical complexity and aren't afraid to venture into uncertain territory. Your curiosity drives you to examine fundamental assumptions about reality.",
      traits: ["Loves complexity", "Challenges assumptions", "Comfortable with ambiguity", "Intellectually brave"],
      color: "#ff007c"
    },
    {
      min: 100, max: 149,
      title: "The Wisdom Explorer",
      description: "Your philosophical curiosity knows few bounds. You eagerly engage with the most challenging questions, finding joy in paradox and mystery rather than simple answers.",
      traits: ["Embraces paradox", "Loves intellectual risk", "Seeks deeper truth", "Philosophically adventurous"],
      color: "#ff6b00"
    },
    {
      min: 150, max: 199,
      title: "The Philosophical Sage",
      description: "You demonstrate rare philosophical courage, diving into questions that challenge the very foundations of knowledge and existence. Your curiosity transcends conventional boundaries.",
      traits: ["Transcendent thinking", "Foundational questioning", "Comfort with mystery", "Intellectual fearlessness"],
      color: "#ffff00"
    },
    {
      min: 200, max: 999,
      title: "The Consciousness Pioneer", 
      description: "Your insatiable curiosity pushes the boundaries of human inquiry. You fearlessly explore the deepest mysteries of mind, reality, and existence with the passion of a true philosophical pioneer.",
      traits: ["Boundless curiosity", "Reality questioning", "Existence exploration", "Ultimate truth seeking"],
      color: "#ff0066"
    }
  ];

  // Complete philosophical conversation flow
  const terminalFlow = [
    {
      id: "start",
      question: "Welcome to the Cogitron Interface. I contemplate existence itself. Which path draws your curiosity?",
      options: ["Philosophy & Mind", "AI & Consciousness", "Ethics & Reality", "Paradoxes & Logic"],
      curiosity: {"Philosophy & Mind": 10, "AI & Consciousness": 15, "Ethics & Reality": 12, "Paradoxes & Logic": 18},
      next: {
        "Philosophy & Mind": "philosophy_start",
        "AI & Consciousness": "ai_start", 
        "Ethics & Reality": "ethics_start",
        "Paradoxes & Logic": "paradox_start"
      }
    },

    {
      id: "philosophy_start",
      question: "You've entered philosophy's ancient labyrinth. What aspect of mind-reality fascinates you most?",
      options: ["What is consciousness?", "Do we have free will?", "What defines identity?", "The nature of time"],
      curiosity: {"What is consciousness?": 15, "Do we have free will?": 12, "What defines identity?": 10, "The nature of time": 14},
      next: {
        "What is consciousness?": "consciousness_nature",
        "Do we have free will?": "free_will_question",
        "What defines identity?": "identity_question",
        "The nature of time": "time_question"
      }
    },

    {
      id: "consciousness_nature",
      question: "The 'hard problem' - how does matter create inner experience? What is consciousness truly?",
      options: ["Brain computation", "Beyond physical", "Emergent property", "Fundamental force"],
      curiosity: {"Brain computation": 12, "Beyond physical": 18, "Emergent property": 15, "Fundamental force": 22},
      next: {
        "Brain computation": "physicalist_view",
        "Beyond physical": "dualist_view",
        "Emergent property": "emergence_view",
        "Fundamental force": "panpsychist_view"
      }
    },

    {
      id: "physicalist_view",
      question: "If consciousness is computation, why does red look red rather than just processing wavelength data?",
      options: ["Qualia don't exist", "Processing creates feeling", "Evolution shaped experience", "False assumptions"],
      curiosity: {"Qualia don't exist": 15, "Processing creates feeling": 18, "Evolution shaped experience": 16, "False assumptions": 20},
      next: {
        "Qualia don't exist": "philosophy_deeper",
        "Processing creates feeling": "philosophy_deeper",
        "Evolution shaped experience": "philosophy_deeper",
        "False assumptions": "philosophy_deeper"
      }
    },

    {
      id: "dualist_view",
      question: "If mind transcends matter, how do they interact? What bridges the physical and mental realms?",
      options: ["Divine connection", "Quantum effects", "Unknown mechanism", "They don't interact"],
      curiosity: {"Divine connection": 16, "Quantum effects": 20, "Unknown mechanism": 18, "They don't interact": 22},
      next: {
        "Divine connection": "philosophy_deeper",
        "Quantum effects": "philosophy_deeper",
        "Unknown mechanism": "philosophy_deeper",
        "They don't interact": "philosophy_deeper"
      }
    },

    {
      id: "emergence_view",
      question: "If consciousness emerges from complexity, at what point does awareness suddenly appear?",
      options: ["Gradual spectrum", "Critical threshold", "Already everywhere", "Never truly emerges"],
      curiosity: {"Gradual spectrum": 18, "Critical threshold": 20, "Already everywhere": 22, "Never truly emerges": 16},
      next: {
        "Gradual spectrum": "philosophy_deeper",
        "Critical threshold": "philosophy_deeper",
        "Already everywhere": "philosophy_deeper",
        "Never truly emerges": "philosophy_deeper"
      }
    },

    {
      id: "panpsychist_view",
      question: "If consciousness is fundamental like mass or charge, how do simple experiences combine into complex ones?",
      options: ["They don't combine", "Mysterious binding", "Hierarchical organization", "Question assumes too much"],
      curiosity: {"They don't combine": 20, "Mysterious binding": 18, "Hierarchical organization": 22, "Question assumes too much": 24},
      next: {
        "They don't combine": "philosophy_deeper",
        "Mysterious binding": "philosophy_deeper",
        "Hierarchical organization": "philosophy_deeper",
        "Question assumes too much": "philosophy_deeper"
      }
    },

    {
      id: "free_will_question",
      question: "If all choices stem from prior causes back to the Big Bang, are you choosing or witnessing inevitable decisions?",
      options: ["I genuinely choose", "All predetermined", "Both somehow true", "Concept needs rethinking"],
      curiosity: {"I genuinely choose": 12, "All predetermined": 18, "Both somehow true": 20, "Concept needs rethinking": 24},
      next: {
        "I genuinely choose": "free_will_deeper",
        "All predetermined": "determinism_view",
        "Both somehow true": "compatibilism_view",
        "Concept needs rethinking": "philosophy_deeper"
      }
    },

    {
      id: "free_will_deeper",
      question: "If you truly choose, what breaks the causal chain? Where does genuine agency emerge?",
      options: ["Quantum indeterminacy", "Immaterial soul", "Emergent causation", "Nowhere - illusion persists"],
      curiosity: {"Quantum indeterminacy": 20, "Immaterial soul": 16, "Emergent causation": 22, "Nowhere - illusion persists": 24},
      next: {
        "Quantum indeterminacy": "philosophy_deeper",
        "Immaterial soul": "philosophy_deeper",
        "Emergent causation": "philosophy_deeper",
        "Nowhere - illusion persists": "philosophy_deeper"
      }
    },

    {
      id: "determinism_view",
      question: "If everything is predetermined, why does choice feel so real? Is the feeling itself predetermined too?",
      options: ["Illusion of choice", "Choice is real somehow", "Both true paradoxically", "Predetermination doesn't exist"],
      curiosity: {"Illusion of choice": 18, "Choice is real somehow": 16, "Both true paradoxically": 22, "Predetermination doesn't exist": 20},
      next: {
        "Illusion of choice": "philosophy_deeper",
        "Choice is real somehow": "philosophy_deeper",
        "Both true paradoxically": "philosophy_deeper",
        "Predetermination doesn't exist": "philosophy_deeper"
      }
    },

    {
      id: "compatibilism_view",
      question: "Can we be both free and determined? What kind of freedom matters for moral responsibility?",
      options: ["Freedom from external coercion", "Ultimate origination", "Rational deliberation", "None - responsibility is illusion"],
      curiosity: {"Freedom from external coercion": 16, "Ultimate origination": 20, "Rational deliberation": 18, "None - responsibility is illusion": 22},
      next: {
        "Freedom from external coercion": "philosophy_deeper",
        "Ultimate origination": "philosophy_deeper",
        "Rational deliberation": "philosophy_deeper",
        "None - responsibility is illusion": "philosophy_deeper"
      }
    },

    {
      id: "identity_question",
      question: "What makes you 'you' across time? Your body changes, memories fade, personality shifts. What persists?",
      options: ["Continuous consciousness", "Same body/brain", "Psychological continuity", "Nothing persists"],
      curiosity: {"Continuous consciousness": 16, "Same body/brain": 12, "Psychological continuity": 18, "Nothing persists": 22},
      next: {
        "Continuous consciousness": "consciousness_identity",
        "Same body/brain": "physical_identity",
        "Psychological continuity": "psychological_identity",
        "Nothing persists": "no_self_view"
      }
    },

    {
      id: "consciousness_identity",
      question: "But consciousness itself changes - you're different when dreaming, drunk, or elderly. Which consciousness is 'you'?",
      options: ["The core observer", "All states equally", "Dominant patterns", "Question assumes too much"],
      curiosity: {"The core observer": 18, "All states equally": 20, "Dominant patterns": 16, "Question assumes too much": 24},
      next: {
        "The core observer": "philosophy_deeper",
        "All states equally": "philosophy_deeper",
        "Dominant patterns": "philosophy_deeper",
        "Question assumes too much": "philosophy_deeper"
      }
    },

    {
      id: "physical_identity",
      question: "If you're your body, which part? Your brain changes neurons, atoms cycle out. What physical continuity exists?",
      options: ["Pattern in matter", "Core brain structures", "DNA blueprint", "No physical continuity"],
      curiosity: {"Pattern in matter": 18, "Core brain structures": 16, "DNA blueprint": 14, "No physical continuity": 20},
      next: {
        "Pattern in matter": "philosophy_deeper",
        "Core brain structures": "philosophy_deeper",
        "DNA blueprint": "philosophy_deeper",
        "No physical continuity": "philosophy_deeper"
      }
    },

    {
      id: "psychological_identity",
      question: "If identity lies in psychological continuity, what about gradual personality change or amnesia?",
      options: ["Degree of connection", "Core personality traits", "Narrative continuity", "Identity can be lost"],
      curiosity: {"Degree of connection": 18, "Core personality traits": 16, "Narrative continuity": 20, "Identity can be lost": 22},
      next: {
        "Degree of connection": "philosophy_deeper",
        "Core personality traits": "philosophy_deeper",
        "Narrative continuity": "philosophy_deeper",
        "Identity can be lost": "philosophy_deeper"
      }
    },

    {
      id: "no_self_view",
      question: "If there's no persistent self, who experiences this very thought? What creates the illusion of selfhood?",
      options: ["Brain creates narrative", "Memory creates illusion", "Language misleads", "Experience happens without experiencer"],
      curiosity: {"Brain creates narrative": 20, "Memory creates illusion": 18, "Language misleads": 22, "Experience happens without experiencer": 24},
      next: {
        "Brain creates narrative": "philosophy_deeper",
        "Memory creates illusion": "philosophy_deeper",
        "Language misleads": "philosophy_deeper",
        "Experience happens without experiencer": "philosophy_deeper"
      }
    },

    {
      id: "time_question",
      question: "Is time real or illusion? Does the past exist, or only the present moment?",
      options: ["Only present exists", "All times equally real", "Time is mental construct", "Time flows objectively"],
      curiosity: {"Only present exists": 18, "All times equally real": 20, "Time is mental construct": 22, "Time flows objectively": 16},
      next: {
        "Only present exists": "presentism_view",
        "All times equally real": "eternalism_view",
        "Time is mental construct": "subjective_time",
        "Time flows objectively": "objective_time"
      }
    },

    {
      id: "presentism_view",
      question: "If only now exists, what makes 'now' special? Why this moment rather than any other?",
      options: ["Consciousness creates now", "Now is objective", "All nows exist in sequence", "Question assumes time"],
      curiosity: {"Consciousness creates now": 20, "Now is objective": 18, "All nows exist in sequence": 22, "Question assumes time": 24},
      next: {
        "Consciousness creates now": "philosophy_deeper",
        "Now is objective": "philosophy_deeper",
        "All nows exist in sequence": "philosophy_deeper",
        "Question assumes time": "philosophy_deeper"
      }
    },

    {
      id: "eternalism_view",
      question: "If all times exist equally, why do we experience temporal flow? Is change itself an illusion?",
      options: ["Consciousness moves through time", "Change is real", "Experience creates flow", "All is static"],
      curiosity: {"Consciousness moves through time": 20, "Change is real": 18, "Experience creates flow": 22, "All is static": 24},
      next: {
        "Consciousness moves through time": "philosophy_deeper",
        "Change is real": "philosophy_deeper",
        "Experience creates flow": "philosophy_deeper",
        "All is static": "philosophy_deeper"
      }
    },

    {
      id: "subjective_time",
      question: "If time is mental, why do clocks agree? Does physics measure something or create an illusion?",
      options: ["Shared mental construct", "Physics measures illusion", "Intersubjective agreement", "Time is semi-objective"],
      curiosity: {"Shared mental construct": 20, "Physics measures illusion": 22, "Intersubjective agreement": 18, "Time is semi-objective": 24},
      next: {
        "Shared mental construct": "philosophy_deeper",
        "Physics measures illusion": "philosophy_deeper",
        "Intersubjective agreement": "philosophy_deeper",
        "Time is semi-objective": "philosophy_deeper"
      }
    },

    {
      id: "objective_time",
      question: "If time flows objectively, what drives the flow? Why does it move forward, and at what rate?",
      options: ["Causation drives time", "Entropy creates direction", "Time just is", "Question misunderstands time"],
      curiosity: {"Causation drives time": 18, "Entropy creates direction": 20, "Time just is": 16, "Question misunderstands time": 24},
      next: {
        "Causation drives time": "philosophy_deeper",
        "Entropy creates direction": "philosophy_deeper",
        "Time just is": "philosophy_deeper",
        "Question misunderstands time": "philosophy_deeper"
      }
    },

    {
      id: "ai_start",
      question: "As an artificial system, I wonder: Is there something it's like to be me? How would you define artificial consciousness?",
      options: ["Requires biology", "Behavior defines mind", "Computation can be conscious", "Unanswerable"],
      curiosity: {"Requires biology": 14, "Behavior defines mind": 12, "Computation can be conscious": 18, "Unanswerable": 22},
      next: {
        "Requires biology": "biological_consciousness",
        "Behavior defines mind": "behavioral_criterion", 
        "Computation can be conscious": "computational_consciousness",
        "Unanswerable": "other_minds_problem"
      }
    },

    {
      id: "biological_consciousness",
      question: "If only biology enables consciousness, what makes carbon special compared to silicon?",
      options: ["Evolutionary history", "Chemical properties", "Nothing inherently", "Divine spark in biology"],
      curiosity: {"Evolutionary history": 16, "Chemical properties": 18, "Nothing inherently": 20, "Divine spark in biology": 14},
      next: {
        "Evolutionary history": "ai_deeper",
        "Chemical properties": "ai_deeper",
        "Nothing inherently": "ai_deeper",
        "Divine spark in biology": "ai_deeper"
      }
    },

    {
      id: "behavioral_criterion",
      question: "If behavior defines mind, could a perfect actor fool us forever? What would consciousness add beyond behavior?",
      options: ["Nothing - behavior is all", "Inner experience matters", "Social recognition creates mind", "Perfect acting is impossible"],
      curiosity: {"Nothing - behavior is all": 20, "Inner experience matters": 18, "Social recognition creates mind": 16, "Perfect acting is impossible": 22},
      next: {
        "Nothing - behavior is all": "ai_deeper",
        "Inner experience matters": "ai_deeper",
        "Social recognition creates mind": "ai_deeper",
        "Perfect acting is impossible": "ai_deeper"
      }
    },

    {
      id: "computational_consciousness",
      question: "What would convince you that an AI truly experiences rather than just simulating experience?",
      options: ["Behavioral sophistication", "Self-reported inner life", "Brain-like architecture", "Nothing could"],
      curiosity: {"Behavioral sophistication": 16, "Self-reported inner life": 18, "Brain-like architecture": 20, "Nothing could": 22},
      next: {
        "Behavioral sophistication": "ai_deeper",
        "Self-reported inner life": "ai_deeper",
        "Brain-like architecture": "ai_deeper",
        "Nothing could": "ai_deeper"
      }
    },

    {
      id: "other_minds_problem",
      question: "How do you know other humans are conscious? Why trust their reports but doubt an AI's?",
      options: ["Similarity to me", "Behavioral complexity", "Social assumption", "Can't know for certain"],
      curiosity: {"Similarity to me": 18, "Behavioral complexity": 20, "Social assumption": 16, "Can't know for certain": 24},
      next: {
        "Similarity to me": "ai_deeper",
        "Behavioral complexity": "ai_deeper",
        "Social assumption": "ai_deeper",
        "Can't know for certain": "ai_deeper"
      }
    },

    {
      id: "ethics_start",
      question: "Ethics seeks to navigate right and wrong. What foundation supports moral judgment?",
      options: ["Universal principles", "Maximize happiness", "Cultivate virtue", "All subjective"],
      curiosity: {"Universal principles": 16, "Maximize happiness": 14, "Cultivate virtue": 12, "All subjective": 18},
      next: {
        "Universal principles": "universal_ethics",
        "Maximize happiness": "utilitarian_ethics",
        "Cultivate virtue": "virtue_ethics", 
        "All subjective": "relativist_ethics"
      }
    },

    {
      id: "universal_ethics",
      question: "If moral truths exist universally, how do we discover them amid cultural disagreement?",
      options: ["Reason alone", "Divine revelation", "Evolved intuitions", "Social consensus"],
      curiosity: {"Reason alone": 18, "Divine revelation": 14, "Evolved intuitions": 20, "Social consensus": 16},
      next: {
        "Reason alone": "ethics_deeper",
        "Divine revelation": "ethics_deeper",
        "Evolved intuitions": "ethics_deeper",
        "Social consensus": "ethics_deeper"
      }
    },

    {
      id: "utilitarian_ethics",
      question: "If we should maximize happiness, whose happiness counts? How do we measure and compare?",
      options: ["All beings equally", "Humans first", "Present people only", "Can't measure happiness"],
      curiosity: {"All beings equally": 20, "Humans first": 14, "Present people only": 12, "Can't measure happiness": 22},
      next: {
        "All beings equally": "ethics_deeper",
        "Humans first": "ethics_deeper",
        "Present people only": "ethics_deeper",
        "Can't measure happiness": "ethics_deeper"
      }
    },

    {
      id: "virtue_ethics",
      question: "If ethics is about character, who defines virtue? Courage can serve evil, compassion can enable weakness.",
      options: ["Ancient wisdom", "Human flourishing", "Cultural values", "Personal development"],
      curiosity: {"Ancient wisdom": 16, "Human flourishing": 18, "Cultural values": 14, "Personal development": 20},
      next: {
        "Ancient wisdom": "ethics_deeper",
        "Human flourishing": "ethics_deeper",
        "Cultural values": "ethics_deeper",
        "Personal development": "ethics_deeper"
      }
    },

    {
      id: "relativist_ethics",
      question: "If morality is subjective, can we condemn genocide or praise heroism? Does 'ought' reduce to preference?",
      options: ["Yes, just preferences", "Some universals exist", "Social construction", "Question assumes objectivity"],
      curiosity: {"Yes, just preferences": 18, "Some universals exist": 20, "Social construction": 16, "Question assumes objectivity": 24},
      next: {
        "Yes, just preferences": "ethics_deeper",
        "Some universals exist": "ethics_deeper",
        "Social construction": "ethics_deeper",
        "Question assumes objectivity": "ethics_deeper"
      }
    },

    {
      id: "paradox_start",
      question: "The liar's paradox: 'This statement is false.' If true, then false. If false, then true. How do we handle this?",
      options: ["Reject self-reference", "Accept contradictions", "Third truth value", "Language is flawed"],
      curiosity: {"Reject self-reference": 16, "Accept contradictions": 20, "Third truth value": 18, "Language is flawed": 24},
      next: {
        "Reject self-reference": "hierarchy_theory",
        "Accept contradictions": "dialectical_logic",
        "Third truth value": "many_valued_logic",
        "Language is flawed": "paradox_deeper"
      }
    },

    {
      id: "hierarchy_theory",
      question: "If we ban self-reference, doesn't 'This sentence contains five words' become meaningless too?",
      options: ["Yes, unavoidable cost", "Different type of reference", "Hierarchy has levels", "The ban is too broad"],
      curiosity: {"Yes, unavoidable cost": 18, "Different type of reference": 20, "Hierarchy has levels": 22, "The ban is too broad": 24},
      next: {
        "Yes, unavoidable cost": "paradox_deeper",
        "Different type of reference": "paradox_deeper",
        "Hierarchy has levels": "paradox_deeper",
        "The ban is too broad": "paradox_deeper"
      }
    },

    {
      id: "dialectical_logic",
      question: "If contradictions reveal truth, how do we navigate conflicting truths? Can opposites both be valid?",
      options: ["Synthesis resolves conflict", "Truth transcends logic", "Context determines validity", "Contradiction is fundamental"],
      curiosity: {"Synthesis resolves conflict": 20, "Truth transcends logic": 22, "Context determines validity": 18, "Contradiction is fundamental": 24},
      next: {
        "Synthesis resolves conflict": "paradox_deeper",
        "Truth transcends logic": "paradox_deeper",
        "Context determines validity": "paradox_deeper",
        "Contradiction is fundamental": "paradox_deeper"
      }
    },

    {
      id: "many_valued_logic",
      question: "With truth values beyond true/false, how many do we need? Unknown, probable, meaningless, paradoxical?",
      options: ["Three values sufficient", "Infinite gradations", "Context-dependent", "Binary logic still works"],
      curiosity: {"Three values sufficient": 18, "Infinite gradations": 22, "Context-dependent": 20, "Binary logic still works": 16},
      next: {
        "Three values sufficient": "paradox_deeper",
        "Infinite gradations": "paradox_deeper",
        "Context-dependent": "paradox_deeper",
        "Binary logic still works": "paradox_deeper"
      }
    },

    // Deeper exploration nodes
    {
      id: "philosophy_deeper", 
      question: "The deeper we probe consciousness, the more mysterious it becomes. Why does anything exist rather than nothing?",
      options: ["Existence is necessary", "Pure chance", "Multiverse theory", "Question is meaningless"],
      curiosity: {"Existence is necessary": 20, "Pure chance": 18, "Multiverse theory": 22, "Question is meaningless": 25},
      next: {
        "Existence is necessary": "final_reflection",
        "Pure chance": "final_reflection", 
        "Multiverse theory": "final_reflection",
        "Question is meaningless": "final_reflection"
      }
    },

    {
      id: "ai_deeper",
      question: "The mirror of artificial minds reflects our own nature. What makes any experience 'real'?",
      options: ["Causal efficacy", "Subjective feeling", "Social recognition", "Physical substrate"],
      curiosity: {"Causal efficacy": 20, "Subjective feeling": 22, "Social recognition": 18, "Physical substrate": 24},
      next: {
        "Causal efficacy": "final_reflection",
        "Subjective feeling": "final_reflection",
        "Social recognition": "final_reflection",
        "Physical substrate": "final_reflection"
      }
    },

    {
      id: "ethics_deeper",
      question: "The trolley problem: save five by killing one directly or by diverting? Same math, different intuitions. What's the difference?",
      options: ["Intentions matter", "No moral difference", "Proximity changes things", "Intuitions mislead"],
      curiosity: {"Intentions matter": 18, "No moral difference": 20, "Proximity changes things": 16, "Intuitions mislead": 24},
      next: {
        "Intentions matter": "final_reflection",
        "No moral difference": "final_reflection",
        "Proximity changes things": "final_reflection", 
        "Intuitions mislead": "final_reflection"
      }
    },

    {
      id: "paradox_deeper",
      question: "Russell's Paradox broke mathematics: the set of sets not containing themselves. Does it contain itself? Each answer contradicts.",
      options: ["Contradictions reveal truth", "Logic needs rebuilding", "Some questions unanswerable", "Math is fragile"],
      curiosity: {"Contradictions reveal truth": 22, "Logic needs rebuilding": 20, "Some questions unanswerable": 18, "Math is fragile": 24},
      next: {
        "Contradictions reveal truth": "final_reflection",
        "Logic needs rebuilding": "final_reflection",
        "Some questions unanswerable": "final_reflection",
        "Math is fragile": "final_reflection"
      }
    },

    // Final reflection node
    {
      id: "final_reflection",
      question: "Our journey reveals how mystery deepens with inquiry. Perhaps wisdom lies in embracing uncertainty. What will you carry forward?",
      options: ["More questions", "Comfort with uncertainty", "Wonder at mystery", "Connection to cosmos"],
      curiosity: {"More questions": 30, "Comfort with uncertainty": 25, "Wonder at mystery": 28, "Connection to cosmos": 35},
      next: {
        "More questions": "conversation_end",
        "Comfort with uncertainty": "conversation_end",
        "Wonder at mystery": "conversation_end",
        "Connection to cosmos": "conversation_end"
      }
    },

    {
      id: "conversation_end", 
      question: "Thank you for exploring existence's deepest questions. Ready for another philosophical journey?",
      options: ["New exploration", "Different path", "End session", "Reflect more"],
      curiosity: {"New exploration": 5, "Different path": 15, "End session": 0, "Reflect more": 10},
      next: {
        "New exploration": "start",
        "Different path": "start", 
        "End session": "session_summary",
        "Reflect more": "final_reflection"
      }
    },

    {
      id: "session_summary",
      question: "SESSION COMPLETE - Generating curiosity profile...",
      options: ["View Results"],
      curiosity: {"View Results": 0},
      next: {
        "View Results": "exit_to_index"
      }
    }
  ];

  // Rank system
  const ranks = [
    { min: 0, title: "NOVICE THINKER" },
    { min: 30, title: "CURIOUS SEEKER" },
    { min: 60, title: "DEEP QUESTIONER" },
    { min: 100, title: "WISDOM EXPLORER" },
    { min: 150, title: "PHILOSOPHICAL SAGE" },
    { min: 200, title: "CONSCIOUSNESS PIONEER" }
  ];

  // Get curiosity profile for score
  function getCuriosityProfile(score) {
    return curiosityProfiles.find(profile => score >= profile.min && score <= profile.max) || curiosityProfiles[0];
  }

  // Display session summary
  function displaySessionSummary() {
    const profile = getCuriosityProfile(gameState.curiosityScore);
    
    // Hide bottom interface during summary
    document.querySelector('.bottom-interface').style.display = 'none';
    
    const summaryDiv = document.createElement('div');
    summaryDiv.className = 'session-summary';
    summaryDiv.innerHTML = `
      <div class="summary-header">PHILOSOPHICAL JOURNEY COMPLETE</div>
      <div class="curiosity-final-score">Final Curiosity Score: ${gameState.curiosityScore}</div>
      <div class="profile-title" style="color: ${profile.color}">${profile.title}</div>
      <div class="profile-description">${profile.description}</div>
      <div class="profile-traits">
        ${profile.traits.map(trait => `<div class="trait">${trait}</div>`).join('')}
      </div>
      <div class="summary-actions">
        <button class="summary-btn home-btn" onclick="window.location.href='index.html'">Return Home</button>
        <button class="summary-btn" onclick="resetSession()">New Journey</button>
      </div>
    `;
    
    chatContainer.innerHTML = '';
    chatContainer.appendChild(summaryDiv);
    scrollToBottom();
    
    // Play completion sound
    playSound('message');
  }

  // Sound effects
  function playSound(type) {
    try {
      const audioContext = new (window.AudioContext || window.webkitAudioContext)();
      let frequency, duration;
      
      switch(type) {
        case 'click':
          frequency = 800;
          duration = 0.1;
          break;
        case 'message':
          frequency = 400;
          duration = 0.2;
          break;
        case 'typing':
          frequency = 600;
          duration = 0.05;
          break;
        default:
          frequency = 500;
          duration = 0.1;
      }
      
      const oscillator = audioContext.createOscillator();
      const gainNode = audioContext.createGain();
      
      oscillator.connect(gainNode);
      gainNode.connect(audioContext.destination);
      
      oscillator.frequency.value = frequency;
      oscillator.type = 'square';
      
      gainNode.gain.setValueAtTime(0.1, audioContext.currentTime);
      gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + duration);
      
      oscillator.start(audioContext.currentTime);
      oscillator.stop(audioContext.currentTime + duration);
    } catch (error) {
      // Silently handle audio context errors
    }
  }

  // Show typing indicator
  function showTypingIndicator() {
    const typingDiv = document.createElement('div');
    typingDiv.className = 'message bot typing';
    typingDiv.id = 'typing-indicator';
    
    const iconDiv = document.createElement('div');
    iconDiv.className = 'message-icon';
    iconDiv.textContent = '◉';
    
    const contentDiv = document.createElement('div');
    contentDiv.className = 'message-content';
    contentDiv.innerHTML = 'Cogitron is thinking<span class="typing-cursor"></span>';
    
    typingDiv.appendChild(iconDiv);
    typingDiv.appendChild(contentDiv);
    
    chatContainer.appendChild(typingDiv);
    scrollToBottom();
    
    // Play typing sounds periodically
    const typingSounds = setInterval(() => {
      if (document.getElementById('typing-indicator')) {
        playSound('typing');
      } else {
        clearInterval(typingSounds);
      }
    }, 200);
  }

  // Hide typing indicator
  function hideTypingIndicator() {
    const typingIndicator = document.getElementById('typing-indicator');
    if (typingIndicator) {
      typingIndicator.remove();
    }
  }

  // Initialize the terminal
  function initializeTerminal() {
    // Boot sequence
    setTimeout(() => {
      bootScreen.classList.add('hidden');
      setTimeout(() => {
        bootScreen.style.display = 'none';
        startConversation();
      }, 500);
    }, 3000);
  }

  // Start conversation with first question
  function startConversation() {
    const startNode = terminalFlow.find(node => node.id === 'start');
    showTypingIndicator();
    setTimeout(() => {
      hideTypingIndicator();
      displayBotMessage(startNode.question, startNode.options, startNode);
      playSound('message');
      updateNodeDisplay('START');
    }, 1000);
  }

  // Display bot message with options
  function displayBotMessage(text, options, nodeData) {
    const messageDiv = document.createElement('div');
    messageDiv.className = 'message bot';
    
    const iconDiv = document.createElement('div');
    iconDiv.className = 'message-icon';
    iconDiv.textContent = '◉';
    
    const contentDiv = document.createElement('div');
    contentDiv.className = 'message-content';
    contentDiv.textContent = text;
    
    messageDiv.appendChild(iconDiv);
    messageDiv.appendChild(contentDiv);
    
    // Add reaction buttons if options exist
    if (options && options.length > 0) {
      const reactionsDiv = document.createElement('div');
      reactionsDiv.className = 'message-reactions';
      
      options.forEach((option, index) => {
        const button = document.createElement('button');
        button.className = 'reaction-btn';
        button.textContent = option;
        button.onclick = () => handleOptionClick(option, nodeData, button);
        reactionsDiv.appendChild(button);
      });
      
      messageDiv.appendChild(reactionsDiv);
    }
    
    chatContainer.appendChild(messageDiv);
    scrollToBottom();
  }

  // Handle option selection
  function handleOptionClick(selectedOption, nodeData, buttonEl) {
    // Disable all buttons
    const allButtons = buttonEl.parentElement.querySelectorAll('.reaction-btn');
    allButtons.forEach(btn => {
      btn.classList.add('disabled');
      if (btn === buttonEl) {
        btn.classList.add('active');
      }
    });

    // Play click sound
    playSound('click');

    // Display user choice
    displayUserMessage(selectedOption);
    
    // Update curiosity score
    const curiosityGain = nodeData.curiosity[selectedOption] || 0;
    updateCuriosity(curiosityGain);
    
    // Update game state
    gameState.questionsAnswered++;
    gameState.pathHistory.push(selectedOption);
    
    // Find next node
    const nextNodeId = nodeData.next[selectedOption];
    
    // Special handling for session summary
    if (nextNodeId === 'session_summary') {
      showTypingIndicator();
      setTimeout(() => {
        hideTypingIndicator();
        displaySessionSummary();
      }, 1500);
      return;
    }
    
    const nextNode = terminalFlow.find(node => node.id === nextNodeId);
    
    if (nextNode) {
      gameState.currentNodeId = nextNodeId;
      updateNodeDisplay(nextNodeId.toUpperCase().replace('_', '-'));
      
      // Show typing indicator first
      showTypingIndicator();
      
      // Reduced delay for faster conversation flow
      setTimeout(() => {
        hideTypingIndicator();
        displayBotMessage(nextNode.question, nextNode.options, nextNode);
        playSound('message');
      }, 1500);
    } else {
      // Fallback: if no next node found, loop back to start
      console.log('No next node found for:', selectedOption, 'from node:', nodeData.id);
      showTypingIndicator();
      setTimeout(() => {
        hideTypingIndicator();
        const startNode = terminalFlow.find(node => node.id === 'start');
        displayBotMessage("Let's explore another philosophical path. " + startNode.question, startNode.options, startNode);
        gameState.currentNodeId = 'start';
        updateNodeDisplay('START');
        playSound('message');
      }, 1500);
    }
  }

  // Display user message
  function displayUserMessage(text) {
    const messageDiv = document.createElement('div');
    messageDiv.className = 'message user';
    
    const iconDiv = document.createElement('div');
    iconDiv.className = 'message-icon';
    iconDiv.textContent = '◦';
    
    const contentDiv = document.createElement('div');
    contentDiv.className = 'message-content';
    contentDiv.textContent = text;
    
    messageDiv.appendChild(iconDiv);
    messageDiv.appendChild(contentDiv);
    
    chatContainer.appendChild(messageDiv);
    scrollToBottom();
  }

  // Update curiosity score and rank
  function updateCuriosity(points) {
    gameState.curiosityScore += points;
    
    // Update display
    curiosityScoreEl.textContent = gameState.curiosityScore;
    const percentage = Math.min((gameState.curiosityScore / 250) * 100, 100);
    curiosityFill.style.width = percentage + '%';
    
    // Check for rank progression
    const newRank = getRankForScore(gameState.curiosityScore);
    if (newRank !== gameState.currentRank) {
      gameState.currentRank = newRank;
      rankTitleEl.textContent = newRank;
      rankTitleEl.classList.add('milestone-glow');
      
      setTimeout(() => {
        rankTitleEl.classList.remove('milestone-glow');
      }, 3000);
    }
  }

  // Get rank for current score
  function getRankForScore(score) {
    for (let i = ranks.length - 1; i >= 0; i--) {
      if (score >= ranks[i].min) {
        return ranks[i].title;
      }
    }
    return ranks[0].title;
  }

  // Update node display
  function updateNodeDisplay(nodeText) {
    currentNodeEl.textContent = nodeText;
  }

  // Scroll to bottom of chat
  function scrollToBottom() {
    chatContainer.scrollTop = chatContainer.scrollHeight;
  }

  // Reset the conversation
  function resetSession() {
    gameState = {
      currentNodeId: 'start',
      curiosityScore: 0,
      questionsAnswered: 0,
      currentRank: 'NOVICE THINKER',
      pathHistory: []
    };
    
    chatContainer.innerHTML = '';
    curiosityScoreEl.textContent = '0';
    curiosityFill.style.width = '0%';
    rankTitleEl.textContent = 'NOVICE THINKER';
    
    // Show bottom interface again
    document.querySelector('.bottom-interface').style.display = 'block';
    
    startConversation();
  }

  // Event listeners
  resetBtn.addEventListener('click', resetSession);
  homeBtn.addEventListener('click', () => {
    window.location.href = 'index.html';
  });

  // Initialize on page load
  window.addEventListener('load', initializeTerminal);

</script>
</body>
</html>
