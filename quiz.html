<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Philosopher Quiz</title>
<style>
  body {
    font-family: 'Courier Prime', monospace;
    max-width: 500px;
    margin: 20px auto;
  }
  .quiz-question {
    display: none;
    margin-bottom: 1.5rem;
  }
  .quiz-question.show {
    display: block;
  }
  .quiz-progress-bar-container {
    background-color: #ddd;
    width: 100%;
    height: 12px;
    border-radius: 6px;
    overflow: hidden;
    margin-bottom: 10px;
  }
  .quiz-progress-bar {
    background-color: #925682;
    height: 100%;
    width: 0%;
    transition: width 0.3s ease;
  }
  #quiz-progress {
    margin-bottom: 15px;
    font-size: 0.9rem;
  }
  #next-btn, #retake-btn, #share-btn {
    background-color: #925682;
    color: white;
    border: none;
    padding: 0.6em 1.2em;
    font-family: 'Press Start 2P', cursive;
    cursor: pointer;
    border-radius: 4px;
    margin: 5px 5px 0 0;
    transition: background-color 0.3s ease;
  }
  #next-btn:hover, #retake-btn:hover, #share-btn:hover {
    background-color: #6f3f61;
  }
  .quiz-result {
    text-align: center;
  }
  .quiz-result img {
    max-width: 150px;
    margin-bottom: 1rem;
  }
</style>
</head>
<body>

<div class="quiz-widget">
  <div class="quiz-progress-bar-container">
    <div id="quiz-bar" class="quiz-progress-bar"></div>
  </div>
  <div id="quiz-progress">Question 1 of 4</div>

  <form id="quiz-form">
    <div class="quiz-question show" id="q1">
      <p>1. What drives your decisions most?</p>
      <label><input type="radio" name="q1" value="kant" /> Duty and rules</label><br />
      <label><input type="radio" name="q1" value="nietzsche" /> Personal freedom</label><br />
      <label><input type="radio" name="q1" value="beauvoir" /> Social context and equality</label><br />
      <label><input type="radio" name="q1" value="socrates" /> Asking questions and dialogue</label>
    </div>
    <div class="quiz-question" id="q2">
      <p>2. How do you view truth?</p>
      <label><input type="radio" name="q2" value="kant" /> Absolute and universal</label><br />
      <label><input type="radio" name="q2" value="nietzsche" /> Relative and self-made</label><br />
      <label><input type="radio" name="q2" value="beauvoir" /> Influenced by society</label><br />
      <label><input type="radio" name="q2" value="socrates" /> Always questioned and probed</label>
    </div>
    <div class="quiz-question" id="q3">
      <p>3. What motivates your actions?</p>
      <label><input type="radio" name="q3" value="kant" /> Moral duty</label><br />
      <label><input type="radio" name="q3" value="nietzsche" /> Creating your own values</label><br />
      <label><input type="radio" name="q3" value="beauvoir" /> Fighting social injustice</label><br />
      <label><input type="radio" name="q3" value="socrates" /> Seeking knowledge</label>
    </div>
    <div class="quiz-question" id="q4">
      <p>4. How do you learn best?</p>
      <label><input type="radio" name="q4" value="kant" /> Following structured teaching</label><br />
      <label><input type="radio" name="q4" value="nietzsche" /> Through experience and challenge</label><br />
      <label><input type="radio" name="q4" value="beauvoir" /> From social interaction</label><br />
      <label><input type="radio" name="q4" value="socrates" /> By questioning assumptions</label>
    </div>
    <button type="button" id="next-btn">Next Question</button>
  </form>

  <div id="quiz-result"></div>
</div>

<script>
document.addEventListener("DOMContentLoaded", () => {
  const quizForm = document.getElementById("quiz-form");
  const questions = document.querySelectorAll(".quiz-question");
  const nextBtn = document.getElementById("next-btn");
  const resultBox = document.getElementById("quiz-result");

  let currentStep = 0;

  function hideAllQuestions() {
    questions.forEach(q => q.classList.remove('show'));
  }

  function showQuestion(step) {
    hideAllQuestions();
    if (questions[step]) {
      questions[step].classList.add('show');
      updateProgress(step);
    }
  }

  function updateProgress(step) {
    const progressText = document.getElementById("quiz-progress");
    const progressBar = document.getElementById("quiz-bar");
    progressText.textContent = `Question ${step + 1} of ${questions.length}`;
    progressBar.style.width = `${((step + 1) / questions.length) * 100}%`;
  }

  function submitQuiz() {
    resultBox.innerHTML = `<div id="loading-message">Calculating your philosopher...</div>`;
    resultBox.scrollIntoView({ behavior: "smooth" });

    setTimeout(() => {
      let tally = { kant: 0, nietzsche: 0, beauvoir: 0, socrates: 0 };
      ["q1", "q2", "q3", "q4"].forEach(q => {
        const ans = quizForm.querySelector(`input[name="${q}"]:checked`);
        if (ans) tally[ans.value]++;
      });

      let result = Object.entries(tally).sort((a, b) => b[1] - a[1])[0][0];
      localStorage.setItem("philosopherResult", result);
      showResult(result);
    }, 1500);
  }

  function showResult(philosopher) {
    const messages = {
      kant: {
        text: "ðŸ§  You're like Immanuel Kant â€“ you believe in reason, duty, and universal moral laws.",
        image: "images/kant.png",
      },
      nietzsche: {
        text: "ðŸ”¥ You're like Nietzsche â€“ bold, independent, and all about creating your own values.",
        image: "images/nietzsche.png",
      },
      beauvoir: {
        text: "ðŸŒ¸ You're like Simone de Beauvoir â€“ deeply aware, expressive, and challenging societal norms.",
        image: "images/beauvoir.png",
      },
      socrates: {
        text: "ðŸ’¬ You're like Socrates â€“ curious, reflective, and never stop asking why.",
        image: "images/socrates.png",
      },
    };

    const { text, image } = messages[philosopher];

    quizForm.style.display = "none";

    resultBox.innerHTML = `
      <div class="quiz-result">
        <img src="${image}" alt="${philosopher}" />
        <p>${text}</p>
        <button id="retake-btn">Retake Quiz</button>
        <button id="share-btn">Share Your Result</button>
      </div>
    `;

    document.getElementById("retake-btn").addEventListener("click", () => {
      localStorage.removeItem("philosopherResult");
      resultBox.innerHTML = "";
      quizForm.reset();
      quizForm.style.display = "block";
      currentStep = 0;
      showQuestion(currentStep);
      nextBtn.textContent = "Next Question";
    });

    document.getElementById("share-btn").addEventListener("click", () => {
      const shareText = `I got ${capitalize(philosopher)} in the â€œWhich Philosopher Are You?â€ quiz on Cogito Computo! ðŸ§ `;
      if (navigator.share) {
        navigator.share({
          title: "Cogito Computo Quiz Result",
          text: shareText,
          url: window.location.href,
        }).catch(() => alert("Sharing cancelled."));
      } else {
        navigator.clipboard.writeText(`${shareText} ${window.location.href}`);
        alert("Result copied to clipboard!");
      }
    });

    resultBox.scrollIntoView({ behavior: "smooth" });
  }

  function capitalize(word) {
    return word.charAt(0).toUpperCase() + word.slice(1);
  }

  // Initialization
  const storedResult = localStorage.getItem("philosopherResult");
  if (storedResult) {
    quizForm.style.display = "none";
    showResult(storedResult);
  } else {
    quizForm.style.display = "block";
    showQuestion(currentStep);
  }

  nextBtn.addEventListener("click", () => {
    const currentQuestion = questions[currentStep];
    const selected = currentQuestion.querySelector("input:checked");

    if (!selected) {
      alert("Please select an answer.");
      return;
    }

    currentStep++;
    if (currentStep < questions.length) {
      showQuestion(currentStep);
      nextBtn.textContent = currentStep === questions.length - 1 ? "Submit" : "Next Question";
    } else {
      submitQuiz();
    }
  });
});
</script>

</body>
</html>
